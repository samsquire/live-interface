From 759836bd467f87edb986590f85e397ebe04633db Mon Sep 17 00:00:00 2001
From: Sam Squire <ssquire@thoughtworks.com>
Date: Thu, 26 Dec 2013 03:29:21 +0000
Subject: [PATCH 1/6] Transclusions now work.

---
 .DS_Store                                          |  Bin 12292 -> 15364 bytes
 app.js                                             |   39 +
 controllers/autocomplete.js                        |   14 +-
 controllers/context-controller.js                  |  432 ++++
 controllers/editor.js                              |  101 +-
 controllers/hierarchy_swap.json                    |   58 +
 controllers/shelf.js                               |    1 +
 controllers/spaces.js                              |   32 +-
 controllers/wizard.js                              |   41 +
 directives/angular-content.js                      |   64 +-
 directives/contenteditable.js                      |   10 +-
 directives/context.js                              |    7 +-
 directives/keypress.js                             |    4 +-
 directives/ng-infinite-scroll.min.js               |    2 +
 example.json                                       |  364 ++++
 gazette/storage.lst                                |    3 +
 index.html                                         |    9 +
 indexing-index/LuceneIndexDefinition.xml           |   37 +
 indexing-index/_a.cfs                              |  Bin 0 -> 2357 bytes
 indexing-index/deletable                           |  Bin 0 -> 4 bytes
 indexing-index/segments                            |  Bin 0 -> 27 bytes
 ...mining.txt_00026___1387804771932___5114-0.annic |  Bin 0 -> 4152 bytes
 ...mining.txt_00026___1387804771932___5114-1.annic |  Bin 0 -> 3313 bytes
 indexing/__GATE_SerialDataStore__                  |    2 +
 .../text_mining.txt_00026___1387804771932___5114   |  Bin 0 -> 1621 bytes
 ...or text_mining.txt_00026___1387804771932___3580 |  Bin 0 -> 539 bytes
 livingsystem.sublime-project                       |    2 +-
 livingsystem.sublime-workspace                     | 2099 ++++++--------------
 models/bucket.js                                   |    3 +-
 models/documentModel.js                            |   12 +
 models/subdocument.js                              |   10 +
 patterns/main.jape                                 |   17 +
 patterns/phone.jape                                |   17 +
 prototypes/index.html                              |  163 ++
 repositories/document.js                           |   11 +-
 repositories/feed.js                               |   12 +-
 repositories/shelf.js                              |    1 +
 shellbucket.js                                     |    4 +-
 shellbucket.sh                                     |    4 +-
 styles/autocomplete.css                            |   11 +-
 styles/feed.css                                    |    2 +-
 styles/main.css                                    |    4 +-
 styles/spaces.css                                  |    7 +-
 styles/tree.css                                    |    7 +
 text_mining.txt                                    |   23 +
 utils/cleaner.js                                   |   12 +
 views/autocomplete.html                            |   15 +-
 views/code.html                                    |   17 +-
 views/data.html                                    |    8 +-
 views/demo.html                                    |   31 +-
 views/dropdown.html                                |   10 +
 views/edit-document.html                           |    5 +
 views/editor.html                                  |   13 +-
 views/home.html                                    |    5 +-
 views/jsonlist.html                                |   21 +
 views/shelf.html                                   |   21 +
 views/spaces.html                                  |    7 +-
 views/subdocument.html                             |    4 +
 views/wizard.html                                  |   29 +
 wordlists/.DS_Store                                |  Bin 0 -> 6148 bytes
 wordlists/lists.def                                |    2 +
 wordlists/phone.lst                                |    1 +
 wordlists/storage                                  |    1 +
 wordlists/storage.lst                              |    6 +
 64 files changed, 2265 insertions(+), 1572 deletions(-)
 create mode 100644 controllers/hierarchy_swap.json
 create mode 100644 controllers/wizard.js
 create mode 100644 directives/ng-infinite-scroll.min.js
 create mode 100644 gazette/storage.lst
 create mode 100644 indexing-index/LuceneIndexDefinition.xml
 create mode 100644 indexing-index/_a.cfs
 create mode 100644 indexing-index/deletable
 create mode 100644 indexing-index/segments
 create mode 100644 indexing-index/serialized-files/text_mining.txt_00026___1387804771932___5114/text_mining.txt_00026___1387804771932___5114-0.annic
 create mode 100644 indexing-index/serialized-files/text_mining.txt_00026___1387804771932___5114/text_mining.txt_00026___1387804771932___5114-1.annic
 create mode 100644 indexing/__GATE_SerialDataStore__
 create mode 100644 indexing/gate.corpora.DocumentImpl/text_mining.txt_00026___1387804771932___5114
 create mode 100644 indexing/gate.corpora.SerialCorpusImpl/Corpus for text_mining.txt_00026___1387804771932___3580
 create mode 100644 models/documentModel.js
 create mode 100644 models/subdocument.js
 create mode 100644 patterns/main.jape
 create mode 100644 patterns/phone.jape
 create mode 100644 prototypes/index.html
 create mode 100644 styles/tree.css
 create mode 100644 text_mining.txt
 create mode 100644 utils/cleaner.js
 create mode 100644 views/dropdown.html
 create mode 100644 views/edit-document.html
 create mode 100644 views/jsonlist.html
 create mode 100644 views/subdocument.html
 create mode 100644 views/wizard.html
 create mode 100644 wordlists/.DS_Store
 create mode 100644 wordlists/lists.def
 create mode 100644 wordlists/phone.lst
 create mode 100644 wordlists/storage
 create mode 100644 wordlists/storage.lst

diff --git a/.DS_Store b/.DS_Store
index aca215bb6d7274600aa3810be82c500a6f3b5717..a580efa9dff2b4166dabc5f5b2caae233a652e6f 100644
GIT binary patch
literal 15364
zcmeHMPj4GV6n~pP&N?-a3sMgVR-AeW!FA&}m3pwEg5ZWor6N&Oys?S5Y`l?oT?azI
z;xlmQx8MVC<-mb6;v?`a!tcG^Rx`7^RF;rc&>L&!jd$OBGxK|Y#xo`&?`Sr>O%xE3
zkIHnXg{GqLd#<IjRy=th)Pp?H8O0yR$w?R|VToHGC<2OrBA^H;0*b(^fB^PvF8+<2
zYO4q+0*b&31UNqgs7(6>UF1|!2O2p7fNtQi6!dWp5SgH${emuXDx%PtpB}tI)GLk{
zUM`OJ0kebl3%bZ@E>2!9PF^vxSDa8h869$gu#?x%skVxMB2Y$v&+ZKx&>oE`bI$J^
zO1~qNF0Q4BF!P?{vqw)THO~6X`yuKri#M#(>wQ|%8`6wU=xZ8LX6yC-ba<O&@Yc=5
z`^%V#E0NOJ9z)h?N^DtUI4hOeo7@e|yaqv;y~(=`-ULXWqn%*26X5RXXC&7?Gv<Fo
zWSDabsTiLTdae{~W#L~VHB3+9FiB#z=Qa%~f~pY)$k2O=o}-o*YpJc23Fql~aqaVS
zcpgV-)^7jdt*vitHn#j`({DX`7)^%B{3w}ChUw?W<79pu4M*W%`i1nfK{iW|22*+S
z$sil!jr1R2rszK^xF1HtZ2WlV=H=zV-R^GC+3#KL2A92FdpFp>b9i;t^!?_}ul}3w
z?%n(7!Qi{A?|)eEI^jXZ#zC*;-(R#pqF1@3m*VvFcshxb$ti0`Z2`Lrga@0J4J0AL
zMz&pz9m2wMi@pN#G4QW4DhJgw!xgsZ6k~h~-i#$|-R#De<20c84E(3yckIf%^bFOz
zzDCPwz~EiIJ-Z#)u-k1{*z>1l?P)FLxgFU?)(gje+gSeu@xWHB3ucZ5(;Dx<ZX7i%
zc?#JCaWn(sMOZ^mitnLt@zeL<8yvz<&_~4C*5gRCtoN3sJ*97;jlJY-NxkqmOYhrD
z=$&J>Q>5h-Gaq2iuE%kz`pxjq24<HCim~f);`t_e7O!b0Uj`Eg$KVr6SMQFU{R5<z
z?%jXG9ZSpk$F(|c*%FsQ_!dqzfD1%`*hwoA`lcaj<;=lbfOmue5~z=$m~9>5iJL26
zWzRRP?8|hf;`#825<hZ_#s50^$Kd0w>m{4F$5CJ|q+YhPjkAYYvQ3PeA#U<~e1dPz
z%6K$urVT^F<%M>O_YH~03$%~n^_&CpJg|o+cxp#CZ|duZ28Nr+3~b6$oUkb!PR=kR
zn!B@Soz~B@O|gh@u0CXL_d3{xd;1k3v-FN^EX0Y2CSYJU9Rj#WjOCgMCS5;7qFyUD
zwhD>WgVQ<Sd~&BMpZv1y_ExbV2PCXsiz1*1C<65etmm%+zW@KA{{R1a1^Px2Pz3(-
z2zVR!kMAF08PBgs+!gU%dw}{SDi`Kk<Wxk^$aOrZT*u=JU&r4<W!^SZF6j3Qy2vS>
zpsfDS0J#rwelzL$zv^B=&;O<C#ig&KUd8jj1fDjEfFhs>C<2OrBA^H;0*Zhlpa>`e
Sihv@Z2q*%IfFkg}MBs0%%IZb{

delta 160
zcmZpvXi1P@U|?W$DortDU;r^WfEYvza8E20o2aMAD+ZDW@);Pi7>YN>tmkJGn`|MV
zKl!<!_~a9Uc8rXZ^@Sxi%L}nHPIebA-TX>8fpKz-nCoONiHymwB;qFDlH}gJTat-!
xV@Vd1AT!V~Aduh&60RUiHWq$op3JWj$N{thWHrO&c%G?~Wu+Eu7STu-0sxIUBW?fy

diff --git a/app.js b/app.js
index fc79db5..a6c8154 100644
--- a/app.js
+++ b/app.js
@@ -22,6 +22,9 @@ angular.module('system').config(function($stateProvider, $urlRouterProvider) {
   $stateProvider
     .state('home', {
       url: "/home",
+      data: {
+        choosing: true
+      },
       views: {
         '': {
           templateUrl: 'views/home.html',
@@ -54,6 +57,17 @@ angular.module('system').config(function($stateProvider, $urlRouterProvider) {
       templateUrl: 'views/embed.html',
       controller: 'embed'
     })
+    .state('home.create', {
+      url: '/create',
+      templateUrl: 'views/wizard.html',
+      controller: 'wizard',
+      onEnter: ['$rootScope', function ($rootScope) {
+        $rootScope.$emit('caret', null);
+      }],
+      data: {
+        choosing: false
+      }
+    })
     .state('home.connect', {
       url: '/connect/:documentId/:fieldIndex/:instanceName',
       views: {
@@ -80,6 +94,31 @@ angular.module('system').config(function($stateProvider, $urlRouterProvider) {
         }
       }
     })
+    .state('edit', {
+      url: '/edit/:documentId',
+      controller: 'editor',
+      data: {
+        choosing: true,
+        preopened: true
+      },
+      views: {
+        '': {
+          templateUrl: 'views/edit-document.html'
+        },
+        '@editor': {
+          templateUrl: 'views/editor.html',
+          controller: 'editor'
+        },
+        '@dropdown': {
+          templateUrl: 'views/autocomplete.html',
+          controller: 'autocomplete'
+        },
+        '@shelf': {
+          templateUrl: 'views/shelf.html',
+          controller: 'shelf'
+        }
+      }
+    })
     
     ;
 
diff --git a/controllers/autocomplete.js b/controllers/autocomplete.js
index 24dd08f..fe21a71 100644
--- a/controllers/autocomplete.js
+++ b/controllers/autocomplete.js
@@ -1,5 +1,11 @@
-angular.module('system').controller('autocomplete', ['$scope', '$state', '$rootScope', 'bucket', function ($scope, $state, $rootScope, bucketService) {
+angular.module('system').controller('autocomplete',
+  ['$scope', '$state', '$rootScope', 'bucket',
+  function ($scope, $state, $rootScope, bucketService) {
   $scope.open = false;
+  $scope.choosing = $state.current.data.choosing;
+
+ 
+
   var escapeListener = null;
   $scope.options = [
   [
@@ -11,7 +17,7 @@ angular.module('system').controller('autocomplete', ['$scope', '$state', '$rootS
   ],
   [
     {title: 'Expand', templateUrl: 'views/editor-expand-option.html', type: 'view', kind: 'expand'},
-    {title: 'Create context', action: ''}
+    {title: 'Create something', type: 'stateChange', action: 'home.create'}
 
   ]];
 
@@ -49,6 +55,10 @@ angular.module('system').controller('autocomplete', ['$scope', '$state', '$rootS
     $scope[item.kind]();
   }
 
+  $scope.createContext = function (item) {
+    
+  };
+
   $scope.expand = function () {
     $rootScope.$emit('toggle-editor-expand');
   };
diff --git a/controllers/context-controller.js b/controllers/context-controller.js
index 8cc8fdf..46d11af 100644
--- a/controllers/context-controller.js
+++ b/controllers/context-controller.js
@@ -2,11 +2,443 @@ angular.module('system').controller('contextController', ['$scope', '$rootScope'
   function ($scope, $rootScope, model, $state, metadata, shelfRepository, ActiveDocument) {
 
   $scope.activeField = model;
+  // this is anything that is a data attribute
+  // passed in by the context
   $scope.metadata = metadata;
   
   $scope.code = false;
   $scope.transposed = false;
 
+  if ($scope.metadata.kind === "subdocument") {
+    $scope.documentModel = $scope.feedIds[$scope.metadata.instanceName];
+    // $scope.documentId = 
+    // $scope.itemIndex = $scope.nameToIndex[$scope.metadata.instanceName];
+  }
+
+  $scope.swap = function (fred) {
+
+
+  function mark(parent) {
+      var me;
+      if (!parent.children) return;
+      for (var i = 0; i < parent.children.length; i++) {
+        me = parent.children[i];
+        me.parent = parent;
+        mark(me);
+      }
+    }
+
+    function undefineds(item) {
+        return item !== undefined;
+    }
+
+    function add(addition, to) {
+      to.children.push(addition);
+      addition.parent = to;
+    }
+
+
+    function addChildren(addition, to) {
+      to.children.push.apply(to.children, addition.children);
+      addition.children.forEach(function (child) {
+        remove(child);
+        child.parent = to;
+      });
+    }
+
+    function collapse(node) {
+      var children = node.children[0].children;
+      node.children = children;
+    }
+
+    function deleteEmptyParents(node) {
+      var myParent = node.parent;
+      if (node.children && node.children.length == 0) {
+        remove(node);
+        deleteEmptyParents(myParent);
+      }
+    }
+
+    function replace(node, replacement) {
+      var index = node.parent.children[node.parent.children.indexOf(node)];
+      node.parent.children[index] = replacement;
+    }
+
+    function remove(node) {
+        delete node.parent.children[node.parent.children.indexOf(node)];
+        node.parent.children = node.parent.children.filter(undefineds);
+        // recursively delete empty parents
+        if (node.parent.children.length === 0) {
+          remove(node.parent);
+        }
+        return node;     
+    }
+
+    function parents(node) {
+        if (!node.parent) return [];
+        return [node.parent].concat(parents(node.parent));
+    }
+
+    
+
+    function find(exactName, node) {
+        if (!node.children || node.children.length === 0) return [];
+        var result = [];
+        
+        if (node.name === exactName) {
+          result.push(node);
+          return result.concat.apply(result, node.children.map(function recur(item) {
+            return find(exactName, item);
+          }));
+        }
+        return node.children.map(function recur(item) {
+          return find(exactName, item);
+        });
+    }
+
+    function merge(anotherFred, fred) {
+
+    }
+
+    function newCell(name) {
+      return {name: name, children: []};
+    }
+
+  var items = $scope.activeField.parents;
+  mark(items);
+
+  var fredParents = parents(fred);
+  var root = fredParents[1];
+  console.log("root", root.name, "parents", fredParents);
+  var exactName = fred.name;
+  var frontend = fred.parent;
+
+  // find all existing freds
+  var foundFreds = _.flatten(find(exactName, root));
+
+  // create a replacement fred
+  var newFred = newCell(exactName);
+  var childrenLookup = {};
+  var fredChildren = newFred.children;
+
+  var fredParents = foundFreds.map(function (aFred) {
+    console.log("Inspecting fred", aFred);
+    var myParent = aFred.parent.name;
+    var myParents = parents(aFred);
+
+
+    // clone all parents hierarchy, excluding non-fred stuff
+    
+    var fredParent;
+
+    if (childrenLookup.hasOwnProperty(myParent)) {
+      fredParent = childrenLookup[myParent];
+    } else {
+      // myParents.pop();
+      var parent = myParents.shift();
+      childrenLookup[myParent] = fredParent = newCell(parent.name);
+      
+      // var topParent = myParents.reduce(function (lastParent, aParent) {
+      //   if (aParent == root) {
+      //     return lastParent;
+      //   }
+      //   var clonedParent = newCell(aParent.name);
+      //   lastParent.parent = clonedParent;
+
+      //   clonedParent.children.push(lastParent);
+      //   console.log(lastParent.name, aParent.name);
+      //   return clonedParent;
+      // }, fredParent);
+
+      var lastParent = fredParent;
+      var clonedParent;
+      for (var i = 0; i < myParents.length; i++) {
+        if (myParents[i] === root) {
+          console.log("Skipping");
+          break;
+        }
+        // otherwise clone this parent
+        clonedParent = newCell(myParents[i].name);
+        // put lastParent in this parent
+        lastParent.parent = clonedParent;
+        clonedParent.children.push(lastParent);
+        console.log(lastParent.name, "inside", clonedParent.name);
+        lastParent = clonedParent;
+      }
+
+      if (lastParent) {
+        lastParent.parent = newFred;
+      }
+
+      console.log("new hierarchy", lastParent);
+
+      // fredChildren.push(fredParent);
+      fredChildren.push(lastParent);
+
+    }
+
+    var myChildren = fredParent.children;
+
+    // move fred's children into the copied parent
+    myChildren.push.apply(myChildren, aFred.children);
+    myChildren.forEach(function (child) {
+      child.parent = fredParent;
+    });
+
+    // delete fred
+    remove(aFred);
+    fredParent.parent = newFred;
+    return fredParent;
+  });
+
+  console.log("Newly created fred", newFred);
+  newFred.parent = root.parent;
+  root.children.unshift(newFred);
+
+    // for all of fred's parents
+    // create a copy
+    // move fred's children inside the copied parent
+    // copy fred
+    // put fred in the original parent's place
+
+
+
+
+
+  }
+
+  $scope.swapNEW = function (fred) {
+    function mark(parent) {
+      var me;
+      if (!parent.children) return;
+      for (var i = 0; i < parent.children.length; i++) {
+        me = parent.children[i];
+        me.parent = parent;
+        mark(me);
+      }
+    }
+
+    function undefineds(item) {
+        return item !== undefined;
+    }
+
+    function add(addition, to) {
+      to.children.push(addition);
+      addition.parent = to;
+    }
+
+
+    function addChildren(addition, to) {
+      to.children.push.apply(to.children, addition.children);
+      addition.children.forEach(function (child) {
+        remove(child);
+        child.parent = to;
+      });
+    }
+
+    function collapse(node) {
+      var children = node.children[0].children;
+      node.children = children;
+    }
+
+    function deleteEmptyParents(node) {
+      var myParent = node.parent;
+      if (node.children && node.children.length == 0) {
+        remove(node);
+        deleteEmptyParents(myParent);
+      }
+    }
+
+    function replace(node, replacement) {
+      var index = node.parent.children[node.parent.children.indexOf(node)];
+      node.parent.children[index] = replacement;
+    }
+
+    function remove(node) {
+        delete node.parent.children[node.parent.children.indexOf(node)];
+        node.parent.children = node.parent.children.filter(undefineds); 
+        return node;     
+    }
+
+    function parents(node) {
+        if (!node.parent) return [];
+        return [node.parent].concat(parents(node.parent));
+    }
+
+    
+
+    function find(exactName, node) {
+        if (!node.children || node.children.length === 0) return [];
+        var result = [];
+        
+        if (node.name === exactName) {
+          result.push(node);
+          return result.concat.apply(result, node.children.map(function recur(item) {
+            return find(exactName, item);
+          }));
+        }
+        return node.children.map(function recur(item) {
+          return find(exactName, item);
+        });
+    }
+
+    function merge(anotherFred, fred) {
+
+    }
+
+    function newCell(name) {
+      return {name: name, children: []};
+    }
+
+
+
+  var items = $scope.activeField.parents;
+  mark(items);
+
+  var parents = parents(fred);
+  var root = parents[parents.length - 2];
+  var exactName = fred.name;
+  var frontend = fred.parent;
+
+  
+  var newFred;
+  root.children.forEach(function (child) {
+    var otherFreds = _.flatten(find(exactName, child));
+
+    otherFreds = otherFreds.filter(function (otherFred) {
+      return otherFred != fred;
+    });
+
+    otherFreds.forEach(function (anotherFred) {
+      var newParent = newCell(anotherFred.parent.name);
+      if (!newFred) {
+        newFred = newCell(fred.name);
+      }
+      addChildren(anotherFred, newParent);
+      deleteEmptyParents(anotherFred, []);
+
+      newFred.children.push(newParent);
+      merge(fred);
+    });
+  });
+
+  
+  console.log(newFred);
+  replace(fred, newFred);
+  
+  }
+
+  $scope.swapOLD = function (a, b, p, ai, bi) {
+
+      function mark(parent) {
+      var me;
+      if (!parent.children) return;
+      for (var i = 0; i < parent.children.length; i++) {
+        me = parent.children[i];
+        me.parent = parent;
+        mark(me);
+      }
+    }
+    console.log("marking parents");
+    var items = $scope.activeField.parents;
+    var children = items.children;
+
+    
+
+    function scan(myName, node) {
+      console.log("scanning", node.name);
+      if (node.name === myName) {
+        return [node]
+      } else if (node.children) {
+        return node.children.reduce(function (results, child) {
+
+          return results.concat(scan(myName, child));
+        }, []);
+      } else {
+        return [];
+      }
+
+    }
+
+    function undefineds(item) {
+        return item !== undefined;
+    }
+
+    function cloneNonemptyParents(node, cloned) {
+      var oldParent = node.parent;
+      if (oldParent.children.length > 1) {
+        // delete from this node, it no longer needs it
+        delete node.parent.children[node.parent.children.indexOf(node)];
+        node.parent.children = node.parent.children.filter(undefineds);
+
+        // clone this parent and add ourself to it
+        clonedParent = {name: oldParent.name, children: [node]};
+        node.parent = clonedParent;
+        return clonedParent;
+      }
+      cloneNonemptyParents(oldParent, cloned);
+      return oldParent;
+    }
+
+    function remove(node) {
+      delete node.parent.children[node.parent.children.indexOf(node)];
+      node.parent.children = node.parent.children.filter(undefineds);      
+    }
+
+    function collapse(node) {
+      var children = node.children[0].children;
+      node.children = children;
+    }
+
+    function findLonelyParents(node, lonely) {
+      var oldParent = node.parent;
+      if (oldParent.children.length == 1) {
+        lonely.push(oldParent);
+        collapse(oldParent);
+        findLonelyParents(oldParent, lonely);
+      }
+      return oldParent;
+    }
+
+    function parents(node) {
+      if (!node.parent) return [];
+      return [node.parent].concat(parents(node.parent));
+    }
+
+    var myName = a.name;
+
+    mark(items);
+
+    var parents = parents(a);
+    var myRoot = parents[parents.length - 2];
+    console.log("my root is", myRoot);
+
+    var equivalents = scan(myName, myRoot);
+
+    var invertedParent = {name: a.parent.name, children: []};
+
+    var newChildren = equivalents.reduce(function (results, current) {
+      // remove from existing parent
+      var lonely = [];
+      var oldParent = findLonelyParents(current, lonely);
+      console.log("Inside", current, "Looking at lonely parents", lonely);
+      remove(current);
+      return results.concat(lonely);
+    }, []);
+
+    a.children.forEach(function (child) {
+        console.log("inverted child by putting", a.name, "children into new", a.parent.name);  
+        console.log(child);
+        remove(child);
+        invertedParent.children.push(child);
+        child.parent = invertedParent;
+    });
+
+    var newParent = {name: myName, children: newChildren};
+
+
+  };
+
   $scope.toggleCode = function () {
     $scope.code = !$scope.code;
   };
diff --git a/controllers/editor.js b/controllers/editor.js
index a4554ef..008f315 100644
--- a/controllers/editor.js
+++ b/controllers/editor.js
@@ -1,12 +1,23 @@
-var EditorController = function EditorController ($scope, $state, $rootScope, feed, $templateCache, $http, $compile, keybinding,
-    ListModel, CodeModel, ActiveDocument, DependencyTreeGenerator, BucketModel, socket) {
+var EditorController = function EditorController ($scope, $state, $stateParams, $rootScope, feed,
+    $templateCache, $http, $compile, keybinding,
+    ListModel, CodeModel, ActiveDocument, DependencyTreeGenerator, BucketModel, socket,
+    DocumentModel, SubdocumentModel, cleaner) {
 
   $scope.open = false;
-  $scope.body = "";
 
-  // var list = ListModel();
+  if ($state.current.data.preopened) {
+    $scope.open = true;
+  }
+
+  $scope.feedIds = feed.ids;
 
+  if ($stateParams.documentId) {
+    var doc = $scope.feedIds[$stateParams.documentId];
+    console.log("Editing", $stateParams.documentId, "Copying", doc, "into activeDocument");
+    $.extend(true, ActiveDocument, doc);
+  }
   $scope.activeDocument = ActiveDocument;
+  
 
   // $scope.activeDocument.fields.push(list);
   // list.items.push({text: "hello"});
@@ -54,10 +65,7 @@ var EditorController = function EditorController ($scope, $state, $rootScope, fe
   };
 
   $scope.filteredDocument = function () {
-    var contents = $($.parseHTML($scope.body));
-    var elements = $('<div>').append(contents);
-    contents.remove('.embedded-context');
-    return elements;
+    return cleaner.filter($scope.activeDocument.contents);
   };
 
   $scope.save = function () {
@@ -70,7 +78,43 @@ var EditorController = function EditorController ($scope, $state, $rootScope, fe
       instances: $scope.activeDocument.instances,
       tree: DependencyTreeGenerator.tree(elements)
     }, $scope.saved);
-    $scope.body = "";
+    $scope.activeDocument.contents = "";
+
+
+  };
+
+  $scope.subdocument = function () {
+    console.log("Inserting sub document");
+
+    var shelfData, subDocument;
+
+    subDocument = new DocumentModel();
+    feed.save({
+      contents: "",
+      fields: subDocument.fields,
+      instances: subDocument.instances,
+      tree: []
+    }, function (err, response) {
+      var id = response.id;
+      console.log("Waiting for", id);
+      feed.waitFor(id, function (savedDoc) {
+        console.log("Finished waiting for", response);
+        var subdocumentRef = SubdocumentModel();
+        subdocumentRef.ref = id;
+        var instance = $scope.createInstance();
+        ActiveDocument.fields.push(subdocumentRef);
+        
+        var element = $scope.createContextElement('subdocument', id);
+
+        $scope.insertNode(element);
+        // $compile(element)($scope);
+        $scope.open = true;
+
+      })
+
+    });
+
+    
   };
 
   $scope.saved = function (err, response) {
@@ -126,6 +170,8 @@ var EditorController = function EditorController ($scope, $state, $rootScope, fe
         console.log("Insert at end of line");
         var firstParent = $(node).parentsUntil('.post-body')[0];
         $(firstParent).after(newNode);
+      } else if ($scope.selection.anchorOffset === 0) {
+        $($scope.selection.acnhorNode).after(newNode);
       } else {
         $(node).unwrap();
         var remaining = node.splitText($scope.selection.anchorOffset);
@@ -151,6 +197,7 @@ var EditorController = function EditorController ($scope, $state, $rootScope, fe
     element.attr("data-kind", type);
     element.attr("data-id", model);
     element.attr("href", instance);
+    element.attr("contenteditable", "false");
     return element[0];
   };
 
@@ -188,8 +235,9 @@ var EditorController = function EditorController ($scope, $state, $rootScope, fe
     var element = $scope.createContextElement('list', instance);
 
     $scope.insertNode(element);
-    $compile(element)($scope);
+    // $compile(element)($scope);
     $scope.open = true;
+
   };
 
   $scope.code = function (modelIndex) {
@@ -202,7 +250,7 @@ var EditorController = function EditorController ($scope, $state, $rootScope, fe
     
 
     $scope.insertNode(element);
-    $compile(element)($scope);
+    // $compile(element)($scope);
     $scope.open = true;
     model.refresh = true;
   };
@@ -220,12 +268,30 @@ var EditorController = function EditorController ($scope, $state, $rootScope, fe
     var element = $scope.createContextElement('data', instance);
 
     socket.on('line', function (data) {
-      model.lines.push(data.line);
-      // $scope.$apply();
+      console.log(data);
+      var headers = data.lines.shift().split(/\s+/);
+      var firstline = data.lines[0].split(/\s+/);
+      console.log(firstline);
+      if (firstline.length > headers.length) {
+        headers = _.range(0, firstline.length);
+      }
+      console.log(headers);
+      model.headings.push.apply(model.headings, headers);
+
+      model.lines.push.apply(model.lines, data.lines.map(function (line) {
+        var cells = line.split(/\s+/);
+        var row = headers.reduce(function (row, column) {
+          row[column] = cells.shift();
+          return row;
+        }, {});
+        return row;
+      }));
+
+      console.log(model.lines);
     });
-
+    
     $scope.insertNode(element);
-    $compile(element)($scope);
+    // $compile(element)($scope);
     $scope.open = true;
   });
 
@@ -244,7 +310,8 @@ var EditorController = function EditorController ($scope, $state, $rootScope, fe
 }
 
 
-angular.module('system').controller('editor', ['$scope', '$state', '$rootScope', 'feed',
+angular.module('system').controller('editor', ['$scope', '$state', '$stateParams', '$rootScope', 'feed',
   '$templateCache', '$http', '$compile', 'keybinding', 'ListModel', 'CodeModel', 'ActiveDocument',
-  'DependencyTreeGenerator', 'BucketModel', 'socket', EditorController]);
+  'DependencyTreeGenerator', 'BucketModel', 'socket', 'DocumentModel', 'SubdocumentModel', 'cleaner',
+  EditorController]);
 
diff --git a/controllers/hierarchy_swap.json b/controllers/hierarchy_swap.json
new file mode 100644
index 0000000..f1fefe4
--- /dev/null
+++ b/controllers/hierarchy_swap.json
@@ -0,0 +1,58 @@
+[
+    {
+        "children": {
+            "children": [
+                {
+                    "children": [
+                        {
+                            "name": "fix the gui"
+                        },
+                        {
+                            "name": "connect to the database"
+                        }
+                    ],
+                    "name": "fred"
+                },
+                {
+                    "children": [
+                        {
+                            "name": "overhaul graphics"
+                        }
+                    ],
+                    "name": "bob"
+                }
+            ],
+            "name": "frontend"
+        },
+        "name": "milestone 1"
+    },
+    {
+        "children": [
+            {
+                "children": [
+                    {
+                        "children": [
+                            {
+                                "name": "set up new tables"
+                            }
+                        ],
+                        "name": "fred"
+                    }
+                ],
+                "name": "back end"
+            },
+            {
+                "children": [
+                    {
+                        "name": "buy new servers"
+                    },
+                    {
+                        "name": "set up networking"
+                    }
+                ],
+                "name": "bob"
+            }
+        ],
+        "name": "milestone 2"
+    }
+]
diff --git a/controllers/shelf.js b/controllers/shelf.js
index c86c288..17d7a7b 100644
--- a/controllers/shelf.js
+++ b/controllers/shelf.js
@@ -1,6 +1,7 @@
 angular.module('system').controller('shelf', ['$scope', '$rootScope', 'shelfRepository', 'feed',
   function ($scope, $rootScope, shelfRepository, feedRepository) {
   $scope.shelf = shelfRepository.items;
+  $scope.objects = shelfRepository.objects;
 
   $scope.embed = function (item) {
 
diff --git a/controllers/spaces.js b/controllers/spaces.js
index 1a5bf89..d43dce6 100644
--- a/controllers/spaces.js
+++ b/controllers/spaces.js
@@ -1,19 +1,43 @@
-var SpacesController = function SpacesController ($scope, $state, $rootScope, feed, feedRepository) {
+var SpacesController = function SpacesController
+($scope, $state, $rootScope, feed, cleaner) {
+
+$scope.saveIndex = function (id, index) {
+    $scope.nameToIndex[id] = index;
+  };
 
   feed.fetch(function (docs) {
-      $scope.$apply();
+      // $scope.$apply();
       console.log("Retrieved", docs);
+      $scope.items.forEach(function (feedItem, index) {
+        $scope.saveIndex(feedItem._id, index)
+      });
+      $rootScope.$apply();
   });
 
   $scope.items = feed.items;
+  $scope.feedIds = feed.ids;
+  $scope.nameToIndex = {};
+
+  $scope.openForEditing = function(feedItem) {
+    $state.transitionTo('edit', {
+      documentId: feedItem._id
+    });
+  };
 
   $scope.update = function (feedItem) {
+    console.log(cleaner);
+    feedItem.contents = cleaner.filter(feedItem.html).html();
+    delete feedItem.html;
     console.log(JSON.stringify(feedItem, null, 4));
-    feed.update(feedItem);
+    feed.update(feedItem, function () {
+      console.log("Applying after update");
+      $scope.$apply();
+    });
+
   };
 };
 
 
-angular.module('system').controller('spaces', ['$scope', '$state', '$rootScope', 'feed',
+angular.module('system').controller('spaces', ['$scope', '$state', '$rootScope', 'feed', 'cleaner',
   SpacesController
 ]);
\ No newline at end of file
diff --git a/controllers/wizard.js b/controllers/wizard.js
new file mode 100644
index 0000000..dd376c6
--- /dev/null
+++ b/controllers/wizard.js
@@ -0,0 +1,41 @@
+angular.module('system').controller('wizard',
+  ['$scope', '$rootScope', '$state', 'shelfRepository',
+  function ($scope, $rootScope, $state, shelfRepository) {
+  $scope.$parent.choosing = $state.current.data.choosing;
+  $scope.$on('$destroy', function () {
+    $scope.$parent.choosing = true;
+  });
+
+ $scope.activeStep = 0;
+
+ $scope.name = "";
+ $scope.type = "";
+
+ $scope.steps = ["name", "type"];
+
+ $scope.nextStep = function (event) {
+    console.log("form submit");
+    console.log("on step", $scope.steps[$scope.activeStep]);
+    var value = $scope[$scope.steps[$scope.activeStep]];
+    console.log("Current value:", value);
+    if (value !== "") {
+      $scope.activeStep = $scope.activeStep + 1;
+    } else {
+      return;
+    }
+
+    if ($scope.activeStep === $scope.steps.length) {
+      
+      console.log($scope);
+      shelfRepository.objects.push({
+        type: $scope.type,
+        name: $scope.name,
+      });
+      $scope.$parent.choosing = true;
+      $state.transitionTo("home");
+      $rootScope.$emit("embed-field", {
+        type: "subdocument"
+      });
+    }
+  }
+}]);
\ No newline at end of file
diff --git a/directives/angular-content.js b/directives/angular-content.js
index 8e81578..8fc2320 100644
--- a/directives/angular-content.js
+++ b/directives/angular-content.js
@@ -5,25 +5,63 @@ angular.module('system').directive('angularContent', ['$timeout', '$compile', fu
     link: function ($scope, $element, $attrs) {
       
       var data = $attrs.angularContent;
-      var documentIndex = $scope.$eval($attrs.documentIndex);
+      var model;
+      if ($attrs.documentIndex) {
+        var documentIndex = $scope.$eval($attrs.documentIndex);
+        model = $scope.items[documentIndex];
+      } else {
+        model = $scope.$eval($attrs.documentModel);
+      }
 
       // console.log("linking run angular", documentIndex);
-      var model = $scope.items[documentIndex];
+      
       
       var subDocumentScope = $scope.$new();
       subDocumentScope.activeDocument = model;
+      
+      var template = $("<span>");
+      template.append($.parseHTML($scope.$eval(data)));
+      $element.append(template.contents());
 
-      var template = $scope.$eval(data);
-      var newContent = $.trim(template);
-      $compile(newContent)(subDocumentScope, function (rendered) {
-        // console.log(rendered);
-        $element.append(rendered);
-        // console.log("DONE angular content", rendered);
-        
-        
-      });
-    }
+      loadContexts(subDocumentScope);
+
+      function loadContexts(subDocumentScope) {
+        var freshContexts = $element.find("[rel=embedded]").not(".ng-scope");
+        freshContexts.each(function (i, embed) {
+            $compile(embed)(subDocumentScope, function (rendered) {
+              // $timeout(function () {
+                $(embed).replaceWith(rendered);
+              // });
+          });
+        });
+
+      }
 
+      // $scope.$watch(data, function (template) {
+      //   // var template = $scope.$eval(data);
+      //   var newContent = $.trim(template);
+      //   var dom = angular.element("<span>" + newContent + "</span>");
 
-  };
+      //   $timeout(function () {
+      //       $compile(dom)(subDocumentScope, function (rendered) {
+      //         replacement.replaceWith(rendered);
+      //         replacement = rendered;
+      //       });
+      //   });
+      // });
+
+
+      $scope.$watch(data, function (newTemplate) {
+        if ($attrs.incremental === "false") {
+          var created = $("<span>");
+          created.append($.parseHTML(newTemplate));
+          $element.empty();
+          $element.append(created.contents());
+
+        }
+        loadContexts(subDocumentScope);
+
+      });
+  }
+}
 }]);
\ No newline at end of file
diff --git a/directives/contenteditable.js b/directives/contenteditable.js
index 25f12fe..a13aa88 100644
--- a/directives/contenteditable.js
+++ b/directives/contenteditable.js
@@ -5,14 +5,22 @@ angular.module('system').directive('contenteditable', function() {
       if (!ngModel) {
         return;
       }
+
+
       // view -> model
       $element.on('blur', function () {
           ngModel.$setViewValue($element.html());
       });
+
+      if (attrs.updateViewOnly) {
+        return;
+      }
       
-      $element.on('keydown', function () {
+      $element.on('keyup', function () {
         // can't seem to get this to update the model on each keypress, was hoping
         // this would change the laggy two way bindings
+        ngModel.$setViewValue($element.html());
+        $scope.$apply();
       });
 
       // Sometimes we want to use the original HTML and other
diff --git a/directives/context.js b/directives/context.js
index 1c9280e..d64ce6d 100644
--- a/directives/context.js
+++ b/directives/context.js
@@ -13,6 +13,8 @@ angular.module('system').factory('contextTemplates',
   importTemplate('views/table.html');
   importTemplate('views/code.html');
   importTemplate('views/data.html');
+  importTemplate('views/jsonlist.html');
+  importTemplate('views/subdocument.html');
 }]);
 
 angular.module('system').directive('a', ['$timeout', '$compile', '$templateCache', 'contextTemplates', '$controller',
@@ -52,10 +54,11 @@ angular.module('system').directive('a', ['$timeout', '$compile', '$templateCache
 
       embeddedContent = $compile(templateHtml)(contextScope);
       
-
+    
       $timeout(function () {
         // wait for all the other bindings in the template have finished
         $element.after(embeddedContent);
+        /*
         // console.log("DONE context insertion", embeddedContent.html());
         var focusNodes = embeddedContent.find('.focus');
 
@@ -64,7 +67,9 @@ angular.module('system').directive('a', ['$timeout', '$compile', '$templateCache
         if (focusNodes.length > 0) {
           $(focusNodes).focus();
         }
+        */
       });
+    
       
 
       // console.log(contextTemplateUrl);
diff --git a/directives/keypress.js b/directives/keypress.js
index 2652d58..7809166 100644
--- a/directives/keypress.js
+++ b/directives/keypress.js
@@ -81,11 +81,9 @@ return {
             newItemIndex = currentListIndex + 1;
             break;
           case 13:
-            event.preventDefault();
             return true;
-            break;
           default:
-            event.preventDefault();
+            // event.preventDefault();
             return true;
         };
         event.preventDefault();
diff --git a/directives/ng-infinite-scroll.min.js b/directives/ng-infinite-scroll.min.js
new file mode 100644
index 0000000..d4410b9
--- /dev/null
+++ b/directives/ng-infinite-scroll.min.js
@@ -0,0 +1,2 @@
+/* ng-infinite-scroll - v1.0.0 - 2013-02-23 */
+var mod;mod=angular.module("infinite-scroll",[]),mod.directive("infiniteScroll",["$rootScope","$window","$timeout",function(i,n,e){return{link:function(t,l,o){var r,c,f,a;return n=angular.element(n),f=0,null!=o.infiniteScrollDistance&&t.$watch(o.infiniteScrollDistance,function(i){return f=parseInt(i,10)}),a=!0,r=!1,null!=o.infiniteScrollDisabled&&t.$watch(o.infiniteScrollDisabled,function(i){return a=!i,a&&r?(r=!1,c()):void 0}),c=function(){var e,c,u,d;return d=n.height()+n.scrollTop(),e=l.offset().top+l.height(),c=e-d,u=n.height()*f>=c,u&&a?i.$$phase?t.$eval(o.infiniteScroll):t.$apply(o.infiniteScroll):u?r=!0:void 0},n.on("scroll",c),t.$on("$destroy",function(){return n.off("scroll",c)}),e(function(){return o.infiniteScrollImmediateCheck?t.$eval(o.infiniteScrollImmediateCheck)?c():void 0:c()},0)}}}]);
\ No newline at end of file
diff --git a/example.json b/example.json
index 1a2f8c9..32ddc9b 100644
--- a/example.json
+++ b/example.json
@@ -3,6 +3,370 @@
     "fields": [
       {
         "items": [{"text": "hello?"}]
+      },
+      {
+        "type": "jsonlist",
+        "parents":  {
+                  "children": [
+                  {
+                  "name": "milestone 1",
+                    "children": [
+                    {
+                      "name": "frontend",
+                        "children": [
+                            {
+                                "children": [
+                                    {
+                                        "name": "fix the gui"
+                                    },
+                                    {
+                                        "name": "connect to the database"
+                                    }
+                                ],
+                                "name": "fred"
+                            },
+                            {
+                                "children": [
+                                    {
+                                        "name": "overhaul graphics"
+                                    }
+                                ],
+                                "name": "bob"
+                            }
+                        ]
+                        
+                    },
+                    {
+                      "name": "backend",
+                        "children": [
+                            {
+                                "children": [
+                                    {
+                                        "name": "add input forms"
+                                    }
+                                ],
+                                "name": "fred"
+                            }
+                        ]
+                        
+                    }
+                    ]
+                    
+                },
+                {
+                    "children": [
+                        {
+                            "children": [
+                                {
+                                    "children": [
+                                        {
+                                            "name": "set up new tables"
+                                        }
+                                    ],
+                                    "name": "fred"
+                                }
+                            ],
+                            "name": "back end"
+                        },
+                        {
+                            "children": [
+                            { "name": "bob",
+                              "children": [
+                                {
+                                    "name": "buy new servers"
+                                },
+                                {
+                                    "name": "set up networking"
+                                }]
+                            }],
+                            "name": "frontend"
+                        }
+                    ],
+                    "name": "milestone 2"
+                }
+            ]
+          }
+
+      },
+
+
+
+
+      {
+        "type": "jsonlist",
+        "parents":  {
+                  "children": [
+                  {
+                  "name": "milestone 1",
+                    "children": [
+                    {
+                      "name": "fred",
+                        "children": [
+                            {
+                                "children": [
+                                    {
+                                        "name": "fix the gui"
+                                    },
+                                    {
+                                        "name": "connect to the database"
+                                    }
+                                ],
+                                "name": "frontend"
+                            },
+                            {
+                                  
+                                          "children": [
+                                              {
+                                                  "name": "add input forms"
+                                              }
+                                          ],
+                                          "name": "backend"
+                                      
+                                  
+                              }
+
+                        
+                        ]
+                        
+                    },
+                        {
+                          "name": "frontend",
+                          "children": [
+                                {"children": [
+                                    {
+                                        "name": "overhaul graphics"
+                                    }
+                                ],
+                                "name": "bob"
+                              }]
+                        }
+                    
+                    ]
+                    
+                },
+                {
+                    "children": [
+                        {
+                            "children": [
+                                {
+                                    "children": [
+                                        {
+                                            "name": "set up new tables"
+                                        }
+                                    ],
+                                    "name": "fred"
+                                }
+                            ],
+                            "name": "back end"
+                        },
+                        {
+                            "children": [
+                            { "name": "bob",
+                              "children": [
+                                {
+                                    "name": "buy new servers"
+                                },
+                                {
+                                    "name": "set up networking"
+                                }]
+                            }],
+                            "name": "frontend"
+                        }
+                    ],
+                    "name": "milestone 2"
+                }
+            ]
+          }
+
+      },
+
+
+
+      {
+        "type": "jsonlist",
+        "parents":  {
+                  "children": [
+                  {
+                  "name": "fred",
+                    "children": [
+                    {
+                      "name": "milestone 1",
+                        "children": [
+                            {
+                                "children": [
+                                    {
+                                        "name": "fix the gui"
+                                    },
+                                    {
+                                        "name": "connect to the database"
+                                    }
+                                ],
+                                "name": "frontend"
+                            },
+                            {
+                                "children": [
+                                    {
+                                        "name": "add input forms"
+                                    }
+                                ],
+                                "name": "backend"
+                            }
+                        ]
+                        
+                    },
+                    {
+                      "name": "milestone 2",
+                        "children": [
+                            {
+                                "children": [
+                                    {
+                                        "name": "set up new tables"
+                                    }
+                                ],
+                                "name": "backend"
+                            }
+                        ]
+                        
+                    }
+                    ]
+                    
+                },
+                {
+                    "children": [
+                        {
+                            "children": [
+                                {
+                                    "children": [
+                                        {
+                                            "name": "set up new tables"
+                                        }
+                                    ],
+                                    "name": "fred"
+                                }
+                            ],
+                            "name": "back end"
+                        },
+                        {
+                            "children": [
+                            { "name": "bob",
+                              "children": [
+                                {
+                                    "name": "buy new servers"
+                                },
+                                {
+                                    "name": "set up networking"
+                                }]
+                            }],
+                            "name": "frontend"
+                        }
+                    ],
+                    "name": "milestone 2"
+                }
+            ]
+          }
+
+      },
+
+
+
+
+
+      
+{
+        "type": "jsonlist",
+        "parents":  {
+                  "children": [
+                  {
+                  "name": "milestone 1",
+                    "children": [
+                    {
+                      "name": "frontend",
+                        "children": [
+                            {
+                                "children": [
+                                    {
+                                        "name": "fix the gui"
+                                    },
+                                    {
+                                        "name": "connect to the database"
+                                    }
+                                ],
+                                "name": "fred"
+                            },
+                            {
+                                "children": [
+                                    {
+                                        "name": "overhaul graphics"
+                                    }
+                                ],
+                                "name": "bob"
+                            }
+                        ]
+                        
+                    },
+                    {
+                      "name": "backend",
+                        "children": [
+                            {
+                                "children": [
+                                    {
+                                        "name": "add input forms"
+                                    }
+                                ],
+                                "name": "fred"
+                            }
+                        ]
+                        
+                    }
+                    ]
+                    
+                },
+                {
+                    "children": [
+                        {
+                            "children": [
+                                {
+                                    "children": [
+                                        {
+                                            "name": "set up new tables"
+                                        }
+                                    ],
+                                    "name": "fred"
+                                }
+                            ],
+                            "name": "back end"
+                        },
+                        {
+                            "children": [
+                            { "name": "bob",
+                              "children": [
+                                {
+                                    "name": "buy new servers"
+                                },
+                                {
+                                    "name": "set up networking"
+                                }]
+                            }],
+                            "name": "frontend"
+                        }
+                    ],
+                    "name": "milestone 2"
+                }
+            ]
+          }
+
+      }
+
+
+
+,
+
+      {
+        "items":
+        [
+            {"text": "group contacts"},
+            {"text": "email business relationship management"}
+        ]
       }
     ]
   } 
diff --git a/gazette/storage.lst b/gazette/storage.lst
new file mode 100644
index 0000000..9d3bc38
--- /dev/null
+++ b/gazette/storage.lst
@@ -0,0 +1,3 @@
+MiB
+mb
+GiB
\ No newline at end of file
diff --git a/index.html b/index.html
index 84b76be..314ef7b 100644
--- a/index.html
+++ b/index.html
@@ -21,6 +21,8 @@
   <script src="http://localhost:1445/socket.io/socket.io.js"></script>
   <script src="http://localhost:7003/components/angular-socket-io/socket.js"></script>
 
+
+
   
   <link rel="stylesheet" href="styles/autocomplete.css"/>
   <link rel="stylesheet" href="styles/feed.css"/>
@@ -30,7 +32,10 @@
   <link rel="stylesheet" href="styles/connect.css"/>
   <link rel="stylesheet" href="styles/code-context.css"/>
   <link rel="stylesheet" href="styles/action-dropdown.css"/>
+  <link rel="stylesheet" href="styles/tree.css"/>
+
 
+<link rel="stylesheet" href="http://localhost:8000/font-awesome-4.0.3/css/font-awesome.min.css">
 
   <link rel="stylesheet" type="text/css" class="ui" href="style.css">
   <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/basic.icon.css">
@@ -187,10 +192,13 @@
     
     <script src="app.js" type="text/javascript"></script>
     <script src="utils/analysis.js" type="text/javascript"></script>
+    <script src="utils/cleaner.js" type="text/javascript"></script>
 
     <script src="models/list.js" type="text/javascript"></script>
     <script src="models/code.js" type="text/javascript"></script>
     <script src="models/bucket.js" type="text/javascript"></script>
+    <script src="models/documentModel.js" type="text/javascript"></script>
+    <script src="models/subdocument.js" type="text/javascript"></script>
 
     <script src="directives/follow.js" type="text/javascript"></script>
     <script src="directives/keypress.js" type="text/javascript"></script>
@@ -222,6 +230,7 @@
     <script src="controllers/connect.js" type="text/javascript"></script>
     <script src="controllers/shelf.js" type="text/javascript"></script>
     <script src="controllers/sidebar.js" type="text/javascript"></script>
+    <script src="controllers/wizard.js" type="text/javascript"></script>
 
 
     
diff --git a/indexing-index/LuceneIndexDefinition.xml b/indexing-index/LuceneIndexDefinition.xml
new file mode 100644
index 0000000..8671018
--- /dev/null
+++ b/indexing-index/LuceneIndexDefinition.xml
@@ -0,0 +1,37 @@
+<map>
+  <entry>
+    <string>FEATURES_TO_EXCLUDE</string>
+    <list>
+      <string>SpaceToken</string>
+      <string>Split</string>
+    </list>
+  </entry>
+  <entry>
+    <string>BASE_TOKEN_ANNOTATION_TYPE</string>
+    <string>Token</string>
+  </entry>
+  <entry>
+    <string>ANNOTATION_SETS_NAMES_TO_INCLUDE</string>
+    <list/>
+  </entry>
+  <entry>
+    <string>CorpusIndexFeature</string>
+    <string>AnnicIR</string>
+  </entry>
+  <entry>
+    <string>INDEX_UNIT_ANNOTATION_TYPE</string>
+    <string></string>
+  </entry>
+  <entry>
+    <string>ANNOTATION_SETS_NAMES_TO_EXCLUDE</string>
+    <list/>
+  </entry>
+  <entry>
+    <string>FEATURES_TO_INCLUDE</string>
+    <list/>
+  </entry>
+  <entry>
+    <string>CREATE_TOKENS_AUTOMATICALLY</string>
+    <boolean>true</boolean>
+  </entry>
+</map>
\ No newline at end of file
diff --git a/indexing-index/_a.cfs b/indexing-index/_a.cfs
new file mode 100644
index 0000000000000000000000000000000000000000..46e9c52fc28f05f247596b73249193c3c922e6cb
GIT binary patch
literal 2357
zcmcIkTT|0O7|m`jG=)OBUuGQhC?GZIh1SbBatV+DTL)Toe8~g|ZKi2blkETw5B@S=
zeD^2#Q^YUXP-#*fad6vga?aWF?YCcclVNE4BIri$%;`{smP6=$jNqpLcD)M<aXwT}
zZ{Q|{gsSY<020fJ;CBjr3dLnUm`I7xYKZa?S_@GjLQg_ejF1wdQiKX2S|4E;ajSOt
zrg5Ze+bDJ7I>dB{kFr{ITYax?>pSX3y>X}>q0#NyR^zo=tp@`qH>%ZIeWR|`s``-{
zQV(zG`cCZ-_(N^uK>H8`(GFC^BKX5Eyi?TY0x8hKj#<J>!4(pr1+k3SN6{$Y`fY4%
zER)HIqL@mhMn}`>xw*Nisi}np7%($4KhL1wwfj{T7pJEMfn~?XIgUvM31b%V{KyE#
z*=%-pc6MR{p~=a9+VtTY&oPgQc|r7!<ycNLN8nMG<@~y?>q?<guE@o5S$SH>11>2_
zQDAa+8NMd7%!97s8BNdVwsJo4V3Ox`w{1ERKumed^}0P@I&(egZ(|oq6`5zUHP32V
zj$un3!)y1t{{LQ$!ZKs`mAvr6>Dl(n>+9<u(Mv&a{|r}_;+b1g?na7S{ElVXr#v{4
zHHajH{<*MW1cVW~)7GFlaTwz}ZV_q}&|QtnjS-=Nw?b(+&*;xv@7K7|Rk>WQR4S!X
zQ630|p$NCdY<w?c$Qmn2)3_o_aHM*~l+F#iJ=7;Cvb<|;CML{MUMk7$W9arbhr0QE
zNp2n|%#<GL;DT5Q1F-FQ7+7{WHV{4|WvOmBZPSzXEZa^u_J>Zw?`m(=YRrt#L`bLK
z?Wxst9lD`jE(n~kA}vN?{78eUIz%EaoP2W9l3Yh3EfYQ=w(Xw7Ck7Do{<GoJ1PR1q
zA|%ko#dwVQ@W7)Lc+YrHTmg<N;>P|U4ICG&Gsa>p_R~v9e7KAREzm8L;IZo@II+Jq
zAy?RyEEFU@NF0gk5*IKgZh}h@x8r)Ad!A6HZj|(;=@ZjCH7<u%I@9w_&oMgYtCs7N
hSQvx`<)IO{;PfPnz&i18P~UzsF$2a|SB`rXwV%o~O2hyF

literal 0
HcmV?d00001

diff --git a/indexing-index/deletable b/indexing-index/deletable
new file mode 100644
index 0000000000000000000000000000000000000000..593f4708db84ac8fd0f5cc47c634f38c013fe9e4
GIT binary patch
literal 4
LcmZQzU|;|M00aO5

literal 0
HcmV?d00001

diff --git a/indexing-index/segments b/indexing-index/segments
new file mode 100644
index 0000000000000000000000000000000000000000..b665f4a46a01b7bf03cb6b3bffa55141556179df
GIT binary patch
literal 27
ZcmezW|Nnmm2w($J+(6986rTvBm;h?f1k(Tj

literal 0
HcmV?d00001

diff --git a/indexing-index/serialized-files/text_mining.txt_00026___1387804771932___5114/text_mining.txt_00026___1387804771932___5114-0.annic b/indexing-index/serialized-files/text_mining.txt_00026___1387804771932___5114/text_mining.txt_00026___1387804771932___5114-0.annic
new file mode 100644
index 0000000000000000000000000000000000000000..6d0e8662a27b00e2259326c387f5b14b07666417
GIT binary patch
literal 4152
zcmai1T~8ZF6ulVChao_qDeXh0&09nyV^>AC+D2*`MTr$eqe5FX4-p$@us5uCo!uc|
z9uieml=n($)Q3b>qQ2#S^u2$f&;1WQcg-xl)7fRDy9UmgbLQNc^)B!Kp=z4Y>LdS&
zUq94ASihbm{%9*m_3=-Cee&C%{_9Da=+IOeoT%d=5$zpK@fDNmJzuMOH&Jn@>V6aj
z-MT;YyM0v;54$Sjzxm-P4bu8<e4wJ<?{9<mFaCZ}q3I6Isp#Q1`}?WV9hx1+X`q8R
z>d?jf#|XLu6#<@4wV&uQd5dPXN(Q^?SZi9@;#F^ie$?C8(Mb^XzSyEEJsPUV^pqyE
z)lOioJhD$s)odl2Ce~BtR1A`FZ~@ZMw2-mtX{K336eLZR^)tyUMvgx<%?<s;?<M}Q
z&z{q{phdgV@s9jRdph<8zV7zDIP!E~dHZn~#z#np-*8Po*R-4~+KZfqBWLBRuw7Mp
z8XPcHG)=K%QDBQJ0<-Euo@9>IQ0zM6a5Xq!nnAC0T;ypnOFWmLHHl)+n#0rJfT@O^
z&w5&9YmrNAS0KkX0NXA*Yz+>WmJv0Miaaf5iRXvVs-oC))!}Jyz_hAq5~rrf)S{M{
zdJr=wV9jA_aL{NChde)~Mb_4Y5^KIOW>B2>vcuZofa$Wvi8A+v(9BP#MHeJiKRd@8
z5S&G^@j63`d^x*g4Gx&rai%`qZ1f(K-Hu{{BZ<Jz1jQ2b92QxSWR4cr$9EFvXgX{S
z4w#ynrkjn%t>EjTjkDM#zSp70zC1EttA7GV-^RY)X5-)iE_bkk;%~Mup;<$5rnV!K
z!2wen-)t;el*r<qlW6|b^_s(#6EV)?TIR|rgkZjZ7FUqu{%u2T0mWHwFl6=7;DG6d
zrunOlR;%4^Z*G3pC~KjZ<_IHjTUIPL&ty#zB$?@3tn~tlGu?HV8yqm*#TRE2QG{IX
zX)y&!dftZ?d-BLUtv(7|(_*vX4T9)UD?EwAgR)ls2*pJdr`d6&F*sn_!5uc1ElOmu
z&q=g&>U+=O%ZV80aW8wma}FVx_tD}ClI&w2YRf22yXSB<IAGe-ct?u|agxMGMa~w#
z#5sW?JM+k#tsN9NUI~qJZKP7XDL(W^WxL3;FQPbC;K*fgz!cya_a9NQ=DelW1VNH5
z9YJyh#n#$kZE(PZH?-=l&i6OBi~4DiOKg9J9NY59Y^{C@T+>o!Tl?Ym&F$JQE@jPp
z3dvOzCpvK?GB{v5!O>*VqCgh+oIoF(x;}Hbav;WeJcH{vg%Hel&*BP_+`V6*b_vB<
zpEG2&(cpmTxuy$;sY)V$puXzIDR#5?DJLd6;t2fz!eYsJE^Cq?$y~o;z5I&Exn4T#
z4Gx%I;-95f(FR(?63agz#g;rWORJRvN9$VNt{)w!#Je4YVePv+W!-!Y%{3IqdF6;>
zaKQ8m-_m2{qD&UMB-2~yeS~7)Hx6He1Ex1PlpLkV)#8@8a;H8<vFkgBtHA-&J3L{z
QcS0^dFcwpgSa{+1UkH>m#sB~S

literal 0
HcmV?d00001

diff --git a/indexing-index/serialized-files/text_mining.txt_00026___1387804771932___5114/text_mining.txt_00026___1387804771932___5114-1.annic b/indexing-index/serialized-files/text_mining.txt_00026___1387804771932___5114/text_mining.txt_00026___1387804771932___5114-1.annic
new file mode 100644
index 0000000000000000000000000000000000000000..f1412c90dcacd3393fc55e5ab72c9b5084a693bf
GIT binary patch
literal 3313
zcmaKuPfyf97{*_AS^lH^QPG2m+zcjVF%mW^iAW4=*dP(q$iYyTVYhC##dZ*u1H>4@
z-2{mTh=F+HdwBONc=kK^ysLv@oEeh05PnaeU)$|Yd-jWRX+nc<{rA4NA%oDHN)o?O
z3R1cC;m6G{-~FR3wG^o}4YtMBIuXrpw(=G`c@<v@ubhZD6rLYNLD}=y{c=@!;YL|R
z{69Zzq(SN}#WfLCzMceU`#<+H)K;WU5v@L5TT6v3Qpb9n1~Q1FBK4pD8KJi>BH->+
z`icA#E>VXRNqtFdNl61GKI+lXk1C^!G6|x}gA%pM#=3Y%JCto6Z3~W-f11A~<(fw#
zsbwVPOh%Dr1{;u~q@HHVOPigx;DwN+%*emWw!gJ3&9EoOo3`^N#o3yX)Vk?MIGqcH
zw(NxvxAvSTJGl+R)^>wcabRl40n6Ct)RGS8WprgR?Cdf)6$hp+T>iQ*%T=3J3p=y}
zsN=hkwS5My;=t60Q;j2=Q%gFW*U**2uyfGhR2-NFC1qt**rZz2A-#n%b+-%|q>3X(
zLy|hz;xLRi@lCL)wH+Ml+o){E@c9lK)QSVsu*4lzg*Lr!6KipYcoc;l7#5Eh#EJvc
z2=1x7<N3-Pn^p@uv=gY~8=tjf2Cd@2G$yHSET5kV9^1TH+TneOzAg-V3kI*^z*N9u
zF`lnk&sNJitW#*~#;|qLU{xHLCY#nd>$z%KhjkupJs7r58?1^0)3l`SJNb!;LZL7|
zelKsk(Aq8z`7@OEVpzUlkSh*M3s^M9tWGWIaK1v<B@8<k4Nk>@X%RP7J%~1>b=}a?
z4)1I9@p8)EWrJ67U|McIfx?>Y3Ts)1wTiYr3|m(WR>gs7MdDE&*W)CKH*IDu?=UB5
z?8mS<FqjnwrU2_?L!@|*SoIq=wYGyp-9Y64hSk!bRveh{l+Vo+Up$$&X|=FJyMwwx
z3~RRyTE&5B8=vsYS-VxsI;<bjb_K)MU4vC|VA_Rs$zj#94(lhhUB$3<&tO#?nD!*~
zZlofK{JMBljZ^E3m9~>Z{~5LX$Y%Y4L9aM49pDXe!uIKEL5K1PRYMq79vYO21Jfba
zjU_*-iNxmB(hlzl`mSTxdu;G34ot`Rd}o6&v{|*R!}<+vH!y5HHCPn~rc<oU&*yAT
JE&0E5>o=K{g!KRb

literal 0
HcmV?d00001

diff --git a/indexing/__GATE_SerialDataStore__ b/indexing/__GATE_SerialDataStore__
new file mode 100644
index 0000000..47ff181
--- /dev/null
+++ b/indexing/__GATE_SerialDataStore__
@@ -0,0 +1,2 @@
+1.1
+../indexing-index
\ No newline at end of file
diff --git a/indexing/gate.corpora.DocumentImpl/text_mining.txt_00026___1387804771932___5114 b/indexing/gate.corpora.DocumentImpl/text_mining.txt_00026___1387804771932___5114
new file mode 100644
index 0000000000000000000000000000000000000000..71be0bcf9f8f180882e81ea9e4148db1946309e4
GIT binary patch
literal 1621
zcmV-b2CDfViwFP!000000Hs%5j1xs1pSD-7w|5-(#Q_RhA|wK_E$Ds7CBl7jE2Smv
z9U9Jf%(c^Yx$Vv{JH7Tad>A4a(TGNTQTzg;55&ayq;JFrUX+9fNi;DS<wc_=`k)DF
z&j0LgySMcoOxmQ|otfYN`)hjj7Zfx(+K|VBL^6~!%5h|jW=ch32(`%c7ccd6ew*6S
z=11#Q6c|pAs;FsfT>f+>Q)A<)*<@mNIFU$B&8lN6>aOjLC&p%z6BFt2DHW})?WU)O
zQ&YA54ue$0uwhVvg+>iEt0F~iC1{qY*~6&UBwWL~_6$kjA~6}x5Y@=hI9i{fx=u18
zMHn?TNvj!oc_dJG{3u?)Q5_rk=m@1c!NyP=HD{<Hz#@Tq<I>b<)x=SIA0TTpoSG)d
zCKm{IbrPu4CUCa^yE;p9xTM><n*#OJW70&j3=tzkv!I$lUCY!;3l4j5-de<bzQl&h
zn3H4Z1o8n%Q7e+EMP{voanx>r<yng{@B~q7Y(^!a>Cpq20heB*>YRg|<h05J!J@>g
z47zKl(<#+^w2pBC9$p|xuH`iY>y9%VRa#71;y}iAf!b}U1`*NeR2+nM)egsvY%-TK
z3HY{SnUQg7nb=dqr3L1~MoIx8@S<rsVwqG>s#6q5iqd6iArAr-j<(o2$_WHDGCT*w
zI3wa9tAz6;MQlNl?q@$t|8(-WA0Z&wxDrVfdg{o-<fY%&UH404o1~j86@cu1i%hz>
zM&x*Igg~hHtsl01dSb)PA1%sI&OS10sp4Q|bSeyr>pquVT7!}zE<je;*SBva9(y$~
zW~;oe9_*mrf9kK3@A)LENkyRyhKOonQANQFEg514HG|*wlSR;?duCY}l5<C)PKIVs
z3!ERqdWo3Q%8m*{2nFP~#H$n$NfB`<&fj?Qoep!GF150-kOY=$X*-~)xIm!;PO`#T
zmSz&99M=qMqa=lN*<@omO((mf(~xRr)HIKkH15`)8D*SGfo4?K7KjF^z;lqSQ2~8m
zwy4R%j))2*mm+tfOvivh{`iDIYwIwxu~=+ZzZAN(wDb@Bg6_zN?9X-hUPcg&PS;eY
zKYSVHr@ngY?ynHe!zj2QodhNWG`wP0bn;aO<>y_;w_KUuKI8|5YCXnD<TdoaRTZo-
zfj&^fWo(GBpy47GnL?NvVF*q*2R)6J!4_D-)7-5nyZU1JIYrqSi|x}!!hNy%Ie6?J
zQIs9Afq}un!M?snV)8f)PACZieD!%n5wu7-r)6akl9KQ&UR0EQ>Y?$3^28)OrsP8@
zK{#a2?=4VMD2g%=p2EgF;o(V5*Olr0iXs&b%lzGJxdGP-GUDlT(hogn@80me@a94Q
z1!hpIi-c_KnpvTL1|VAmy4OB&{2N_9b%s0@$sk7^KFeeeeRS>gzK*v)iB(e+N%U$~
z_WMu;l5;x!kQ`U4mGB#VtQLE#xF)e#fYJ&!e{=2g-Xk{y$UlJ;o#N~SR6FIWEEp*2
z0@bq>wr8)EL%wpTnpM#3s$DZ|cX88_v)Ri0tpI7MRsM>elU9CQ9=LevOd{Zy`4S*T
zR-jhfCvpOU58B8AIAjtVS)Fi!BKD!nFY4vDWn98d2M_dqE$f|#Dx_lGItrSyA4_GU
z;A>HxI2HM9wM=PuIs|fynK9;BfQjqtO|*tLDD(2=?L+;)efEb{8=#1!+Zjizs5=5G
z%v+C+c3t1Ud->1j&JIF7s?~brsKdo2O2s+C&s@E*srB{m&Q-(j17__m$QnTB?wtSP
zl?QGEr^l<Dq~u4Prtl!MEFF~Z)?0twddLAHfm#^mIL|RFSSOMH?ISPWfQN6?RlrvV
z^m~BY<zl!Y$w3dpVOA%}1vYtrI~$kW>|vN-b<S{st31Hb#wE9S7(UJFY;=Jk5Aa~)
zl3P6tIjakU3sgM7BaKU5?O}MD)p^$iwt0Y}ami~u3}164H`f8%J;3K1m)z-Lc*T_*
zssna-fEO&u*4U7b9WXk4l?r2Wu?gBqo7GO>)*FHQ&Kp|?`tSMs4iBJaxPcX5evHai
zhniq|3Airfk|@B;7mLmXph@0)s_$~jI`1L4@dyh4V4QUTZtc#TTXH^dOW4!!g$a6=
Tr2=ydy2$<o5G~ru?F|3`5GNGB

literal 0
HcmV?d00001

diff --git a/indexing/gate.corpora.SerialCorpusImpl/Corpus for text_mining.txt_00026___1387804771932___3580 b/indexing/gate.corpora.SerialCorpusImpl/Corpus for text_mining.txt_00026___1387804771932___3580
new file mode 100644
index 0000000000000000000000000000000000000000..98a19a7fec1f5ca3b1174d2eddec227029e96dee
GIT binary patch
literal 539
zcmV+$0_6Q4iwFP!000000BuseYZO5ge|NVriKd7i5&}lAunEZSeI#D=Ku`~1agE@K
z2q&DA_2sf*Z+Dz|t9y!xRyGz9Y%Ek11PdXxe?dAyi-1^Ih@gUvt&KCgo5aW!JM5eJ
zeY~%?zhFoTnCdb@(+vd=1v6VHJm#NOQ6%ji_p9FX&)*+DS<6GtfqgeZx5<b(o+N^C
zXPMn%Rz#j}>6=C@;Ako)F!a$py&y?2mmC&!Bi6-BD8op&Xcq6jY5iQimj_UkLxU(=
z(EHbG_~`e<Mq+OStcL^#QeR)GS}hV@(ACaI5*eM$w#YeT6bU?oOrY5OI{j{C^23ir
zX=E{dk_7u5O|&xX1;!gOS6w;0BiHg&A8-et+w$ql=KQJ0g=Sj9#Q)$7_3GN6)t5Pq
zGHe)e8E39XeH(_{Fbb#*!?c9wv9Gcyw*M*W;=(ez)M&$~dcVT_2<1&!fxR&YfP(rU
z5?c&YGt7*!_WtUNaXIbltP(8eJkr#$EFdVQqb)6lqC^-|r{@K#gC?opa=BbRu4*qP
z!f7joV0}H@_`%1iryJ~90dh7N(z}C+L+-YrPeq#CwMNa*jd~c6-j<Wr`s+RG@>?DX
z4ve}!lk#$(qt454U|8+cyqaqkj&T%H`6;g5+&$~8$XHb|*i5&a;NZZr2#yWB?{qqq
d+FX6EJX5b%PSmO@o~=}7;=e3FqVF98001k+2893s

literal 0
HcmV?d00001

diff --git a/livingsystem.sublime-project b/livingsystem.sublime-project
index c738161..37d76cb 100644
--- a/livingsystem.sublime-project
+++ b/livingsystem.sublime-project
@@ -2,7 +2,7 @@
 	"folders":
 	[
 		{
-     "folder_exclude_patterns": ["components"],
+     "folder_exclude_patterns": ["components", "presentation/node_modules/"],
       "file_exclude_patterns": ["*.sublime-workspace"],
 			"path": "./"
 		}
diff --git a/livingsystem.sublime-workspace b/livingsystem.sublime-workspace
index 0d5b683..0875dd5 100644
--- a/livingsystem.sublime-workspace
+++ b/livingsystem.sublime-workspace
@@ -4,6 +4,22 @@
 		"selected_items":
 		[
 			[
+				"item",
+				"items"
+			],
+			[
+				"list-",
+				"list-style-type"
+			],
+			[
+				"embedd",
+				"embeddedDom"
+			],
+			[
+				"codemir",
+				"codemirrorLoaded"
+			],
+			[
 				"no",
 				"nowrap"
 			],
@@ -80,149 +96,164 @@
 	"buffers":
 	[
 		{
-			"file": "index.html",
+			"file": "presentation/index.html",
 			"settings":
 			{
-				"buffer_size": 11189,
+				"buffer_size": 3417,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "controllers/editor.js",
+			"file": "index.html",
 			"settings":
 			{
-				"buffer_size": 6049,
+				"buffer_size": 14209,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "models/code.js",
+			"file": "views/code.html",
 			"settings":
 			{
-				"buffer_size": 302,
-				"line_ending": "Unix",
-				"name": "angular.module('system').factory('CodeModel', [fun"
+				"buffer_size": 2012,
+				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "views/code.html",
+			"file": "shellbucket.js",
 			"settings":
 			{
-				"buffer_size": 230,
+				"buffer_size": 2045,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "models/list.js",
+			"file": "directives/angular-content.js",
 			"settings":
 			{
-				"buffer_size": 208,
+				"buffer_size": 849,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "views/list.html",
+			"file": "directives/keypress.js",
 			"settings":
 			{
-				"buffer_size": 3062,
+				"buffer_size": 3352,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "controllers/autocomplete.js",
+			"file": "controllers/spaces.js",
 			"settings":
 			{
-				"buffer_size": 1721,
+				"buffer_size": 472,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "directives/context.js",
+			"file": "app.js",
 			"settings":
 			{
-				"buffer_size": 2196,
+				"buffer_size": 2032,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "app.js",
+			"file": "controllers/autocomplete.js",
 			"settings":
 			{
-				"buffer_size": 1723,
+				"buffer_size": 1869,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "styles/main.css",
+			"file": "controllers/editor.js",
 			"settings":
 			{
-				"buffer_size": 1929,
+				"buffer_size": 7723,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "controllers/context-controller.js",
+			"file": "controllers/hierarchy_swap.json",
+			"settings":
+			{
+				"buffer_size": 1487,
+				"line_ending": "Unix",
+				"name": "[ {"
+			}
+		},
+		{
+			"file": "views/data.html",
 			"settings":
 			{
-				"buffer_size": 819,
+				"buffer_size": 292,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "views/editor.html",
+			"file": "bucket.js",
 			"settings":
 			{
-				"buffer_size": 929,
+				"buffer_size": 1083,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "views/connect.html",
+			"file": "models/bucket.js",
 			"settings":
 			{
-				"buffer_size": 870,
+				"buffer_size": 179,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "views/connect-picker.html",
+			"file": "example.json",
 			"settings":
 			{
-				"buffer_size": 826,
+				"buffer_size": 12173,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "views/home.html",
+			"file": "views/demo.html",
 			"settings":
 			{
-				"buffer_size": 194,
+				"buffer_size": 761,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "controllers/connect.js",
+			"file": "views/jsonlist.html",
 			"settings":
 			{
-				"buffer_size": 895,
+				"buffer_size": 495,
 				"line_ending": "Unix"
 			}
 		},
 		{
-			"contents": "Searching 299 files for \"console.log\"\n\n/Users/ssquire/Documents/projects/liveinterface/components/angular/angular.js:\n 3110   * @param {object} document jQuery wrapped document.\n 3111   * @param {function()} XHR XMLHttpRequest constructor.\n 3112:  * @param {object} $log console.log or an object with the same interface.\n 3113   * @param {object} $sniffer $sniffer service\n 3114   */\n ....\n 5920      function consoleLog(type) {\n 5921        var console = $window.console || {},\n 5922:           logFn = console[type] || console.log || noop;\n 5923  \n 5924        if (logFn.apply) {\n ....\n 5933  \n 5934        // we are IE which either doesn't have window.console => this is noop and we do nothing,\n 5935:       // or we are IE where console.log doesn't have apply so we log at least first 2 args\n 5936        return function(arg1, arg2) {\n 5937          logFn(arg1, arg2);\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/addon/search/searchcursor.js:\n  107        for (;;) {\n  108          if (this.pos = this.matches(reverse, pos)) {\n  109:           if (!this.pos.from || !this.pos.to) { console.log(this.matches, this.pos); }\n  110            this.atOccurrence = true;\n  111            return this.pos.match || true;\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/addon/tern/tern.js:\n  591          });\n  592        } else if (data.type == \"debug\") {\n  593:         console.log(data.message);\n  594        } else if (data.id && pending[data.id]) {\n  595          pending[data.id](data.err, data.body);\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/diff/index.html:\n   29  -        autoMatchBrackets: true\n   30  +        autoMatchBrackets: true,\n   31: +      onGutterClick: function(x){console.log(x);}\n   32         });\n   33       </script>\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/gfm/index.html:\n   37  ```javascript\n   38  for (var i = 0; i &lt; items.length; i++) {\n   39:     console.log(items[i], i); // log them\n   40  }\n   41  ```\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/less/less.js:\n  128          //commment out these 2 comment if you want the minus sign to be parsed as null -500px\n  129          //stream.backUp(stream.current().length-1);\n  130:         //return ret(null, ch); //console.log( stream.current() );\n  131          return ret(\"number\", \"unit\");\n  132        }else if( /\\/|[\\s\\)]/.test(stream.peek() || stream.eol() || (stream.eatSpace() && stream.peek() == \"/\")) && stream.current().indexOf(\".\") !== -1){\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/sass/sass.js:\n   55  \n   56        /*\n   57:       console.log(\"previousChar: \" + previousChar);\n   58:       console.log(\"nextChar: \" + nextChar);\n   59:       console.log(\"peekChar: \" + peekChar);\n   60:       console.log(\"ending: \" + endingString);\n   61        */\n   62  \n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/smarty/index.html:\n   88  <script>\n   89  function test() {\n   90: 	console.log(\"Smarty 3 permits single curly braces followed by whitespace to NOT slip into Smarty mode.\");\n   91  }\n   92  </script>\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/vb/index.html:\n   22    var i = 0;\n   23    function callback(token, style, lineNo, pos){\n   24: 		//console.log(String(token) + \" \" + String(style) + \" \" + String(lineNo) + \" \" + String(pos));\n   25      var result = [String(token), String(style)];\n   26      if (golden[i][0] != result[0] || golden[i][1] != result[1]){\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/autocomplete.js:\n   53  \n   54    function listen() {\n   55:     console.log('listening to escape events');\n   56      escapeListener = $rootScope.$on('escape-pressed', $scope.toggle);\n   57    }\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/connect.js:\n   24  \n   25    $scope.use = function () {\n   26:     console.log(\"now using\");\n   27      \n   28      $state.transitionTo('home.connect.use', $stateParams);\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/context-controller.js:\n   17  \n   18    $scope.transpose = function () {\n   19:     console.log('transposing');\n   20      $scope.transposed = !$scope.transposed;\n   21    };\n   22  \n   23    $scope.connect = function (item) {\n   24:     // console.log($scope.activeField, $scope.activeDocument._id);\n   25  \n   26      $state.transitionTo('home.connect', {\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/editor.js:\n   33  \n   34    $rootScope.$on('demote', function () {\n   35:     console.log('demote');\n   36    });\n   37    $rootScope.$on('promote', function () {\n   38:     console.log('promote');\n   39    });\n   40    $rootScope.$on('move-right', function () {\n   41:     console.log('move-right');\n   42    });\n   43    $rootScope.$on('move-up', function () {\n   44:     console.log('move-up');\n   45    });\n   46    $rootScope.$on('move-down', function () {\n   47:     console.log('move-down');\n   48    });\n   49    $rootScope.$on('move-left', function () {\n   50:     console.log('move-left');\n   51    });\n   52  \n   ..\n   56      contents.remove('.embedded-context,.CodeMirror');\n   57      var html = elements.html();\n   58:     console.log('Saving', html);\n   59  \n   60      feed.save({\n   ..\n   67  \n   68    $scope.saved = function (err, response) {\n   69:     console.log('saved', err, response);\n   70    };\n   71  \n   ..\n   75  \n   76    $rootScope.$on('embed-field', function (event, field) {\n   77:     console.log('Embedding', field);\n   78      $scope[$scope.activeDocument.fields[field].type](field);\n   79    });\n   ..\n   85      });\n   86      if (node.nodeType !== 3) {\n   87:       console.log(\"Not a text node. Ensuring flattened structure.\", node.parentNode);\n   88        // node = $(node).parentsUntil('.post-body')[0];\n   89        var oneDeep = $(node).parentsUntil('.post-body');\n   ..\n  101          \n  102        } else {\n  103:         console.log(\"Inserting before the selected node\");\n  104         node = node.previousSibling;\n  105        }\n  ...\n  109      \n  110      if (parents.length === 1) {\n  111:       console.log(node.textContent.length);\n  112        if (node.textContent.length === $scope.selection.anchorOffset) {\n  113:         console.log(\"Insert at end of line\");\n  114          var firstParent = $(node).parentsUntil('.post-body')[0];\n  115          $(firstParent).after(newNode);\n  ...\n  120          $(node).wrap(\"<div>\");\n  121          $(remaining).wrap(\"<div>\");\n  122:         console.log(\"Text split at\", $scope.selection.anchorOffset);\n  123        }\n  124      } else {\n  125        $('.post-body').append(newNode);\n  126:       console.log('selection not inside text area');\n  127      }\n  128      if (newNode.nodeType === 3) {\n  ...\n  147      var model;\n  148     if (modelIndex === undefined) {\n  149:       console.log(\"Creating empty model.\");\n  150        model = modelConstructor();\n  151        \n  152        $scope.activeDocument.fields.push(model);\n  153      } else {\n  154:       console.log(\"Using pre-existing model.\");\n  155        model = $scope.activeDocument.fields[modelIndex];\n  156      }\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/spaces.js:\n    6        // $scope.items.push.apply($scope.items, docs);\n    7        $scope.$apply();\n    8:       console.log(\"Retrieved\", docs);\n    9    });\n   10  \n   11    $scope.items = feed.items;\n   12    \n   13:   console.log('loaded feed items', feed.items);\n   14    \n   15  \n   16    $scope.update = function (feedItem) {\n   17:     console.log(JSON.stringify(feedItem, null, 4));\n   18      feed.update(feedItem);\n   19    };\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/viewer.js:\n    1  angular.module('system').controller('viewer', ['$scope', 'demoData',\n    2    function ($scope, demoData) {\n    3:     console.log('data from promise', demoData.data);\n    4    angular.extend($scope, demoData.data);\n    5  }]);\n\n/Users/ssquire/Documents/projects/liveinterface/directives/angular-content.js:\n    8        var documentIndex = $scope.$eval($attrs.documentIndex);\n    9  \n   10:       console.log(\"linking run angular\", documentIndex);\n   11        var model = $scope.items[documentIndex];\n   12        \n   ..\n   17        var newContent = $.trim(template);\n   18        $compile(newContent)(subDocumentScope, function (rendered) {\n   19:         console.log(rendered);\n   20          $element.append(rendered);\n   21:         console.log(\"DONE angular content\", rendered);\n   22          \n   23          \n\n/Users/ssquire/Documents/projects/liveinterface/directives/contenteditable.js:\n   12        \n   13        $element.on('keydown', function () {\n   14:         console.log('change');\n   15        });\n   16  \n\n/Users/ssquire/Documents/projects/liveinterface/directives/context.js:\n    4    function importTemplate(url) {\n    5      $http.get(url).then(function (templateData) {\n    6:       console.log(\"Imported template for\", url);\n    7        $templateCache.put(url, templateData.data);\n    8      });\n    .\n   36          instanceName: $element.attr('href')\n   37        };\n   38:       console.log(\"Active Document is\", $scope.activeDocument);\n   39        model = $scope.activeDocument.fields[metadata.fieldIndex];\n   40:       console.log('Encountered context', model);\n   41  \n   42        contextTemplateUrl = 'views/' + metadata.kind + '.html';\n   ..\n   56          // wait for all the other bindings in the template have finished\n   57          $element.after(embeddedContent);\n   58:         // console.log(\"DONE context insertion\", embeddedContent.html());\n   59          var focusNodes = embeddedContent.find('.focus');\n   60  \n   ..\n   67        \n   68  \n   69:       // console.log(contextTemplateUrl);\n   70:       // console.log('Got template HTML', templateHtml);\n   71      }\n   72    };\n\n/Users/ssquire/Documents/projects/liveinterface/directives/follow.js:\n   16        pos = _.pick(pos, ['left', 'top']);\n   17        \n   18:       // console.log(\"Keypress:\", $(this).text(), sel, sel.focusNode, $(sel.focusNode.parentElement).position());\n   19        var rightEdge = pos.left + dropdown.width();\n   20        \n   ..\n   22        \n   23        if (rightEdge >= windowWidth) {\n   24:         console.log(\"Over the edge,\", rightEdge, windowWidth, pos);\n   25          var newLeft = pos.left - (rightEdge - windowWidth);\n   26          pos.left = newLeft;\n\n/Users/ssquire/Documents/projects/liveinterface/directives/keypress.js:\n   40        var index = event.keyCode - 48;\n   41        var selected = $element.find(validOptions).get(index - 1)\n   42:       console.log(index, selected);\n   43        selected.focus();\n   44        selected.click();\n   ..\n   53  return {\n   54    link: function ($scope, $element, $attrs) {\n   55:     var settings = $scope.$eval($attrs.directionalFocus); console.log(settings);\n   56      var validElement = settings.container;\n   57      var validItems = settings.items;\n\n/Users/ssquire/Documents/projects/liveinterface/repositories/feed.js:\n   22        docs.forEach(function (doc) {\n   23          if (self.ids.hasOwnProperty(doc._id)) {\n   24:           console.log(\"Change to existing document:\", doc._id);\n   25:           // console.log('already existing doc', doc, doc._id);\n   26            $.extend(true, self.ids[doc._id], doc);\n   27  \n   ..\n   36        \n   37        var opts = {continuous: true, complete: function (err) {\n   38:         // console.log('complete handler', err)\n   39        }};\n   40        db.replicate.to(remoteCouch, opts);\n   ..\n   59            continuous: true,\n   60            onChange: function(change) {\n   61: //            console.log('change occurred', change.doc);\n   62              if (!change.doc._deleted) {\n   63                self.addition([change.doc])\n   ..\n   76  \n   77      self.update = function (feedItem) {\n   78:       console.log('Updated', feedItem);\n   79        var rev = feedItem._rev;\n   80        db.remove(feedItem);\n   81        var revNumber = (parseInt(feedItem._rev.substr(0, 2), 10) + 1);\n   82        feedItem._rev = revNumber + feedItem._rev.substring(feedItem._rev.indexOf(\"-\"));\n   83:       console.log(revNumber, 'From', rev, 'to', feedItem._rev);\n   84        db.put(feedItem, {}, function (err) {\n   85:         console.log(err);\n   86        });\n   87      };\n\n60 matches across 21 files\n\n\nSearching 299 files for \"console.log\"\n\n/Users/ssquire/Documents/projects/liveinterface/components/angular/angular.js:\n 3110   * @param {object} document jQuery wrapped document.\n 3111   * @param {function()} XHR XMLHttpRequest constructor.\n 3112:  * @param {object} $log console.log or an object with the same interface.\n 3113   * @param {object} $sniffer $sniffer service\n 3114   */\n ....\n 5920      function consoleLog(type) {\n 5921        var console = $window.console || {},\n 5922:           logFn = console[type] || console.log || noop;\n 5923  \n 5924        if (logFn.apply) {\n ....\n 5933  \n 5934        // we are IE which either doesn't have window.console => this is noop and we do nothing,\n 5935:       // or we are IE where console.log doesn't have apply so we log at least first 2 args\n 5936        return function(arg1, arg2) {\n 5937          logFn(arg1, arg2);\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/addon/search/searchcursor.js:\n  107        for (;;) {\n  108          if (this.pos = this.matches(reverse, pos)) {\n  109:           if (!this.pos.from || !this.pos.to) { console.log(this.matches, this.pos); }\n  110            this.atOccurrence = true;\n  111            return this.pos.match || true;\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/addon/tern/tern.js:\n  591          });\n  592        } else if (data.type == \"debug\") {\n  593:         console.log(data.message);\n  594        } else if (data.id && pending[data.id]) {\n  595          pending[data.id](data.err, data.body);\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/diff/index.html:\n   29  -        autoMatchBrackets: true\n   30  +        autoMatchBrackets: true,\n   31: +      onGutterClick: function(x){console.log(x);}\n   32         });\n   33       </script>\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/gfm/index.html:\n   37  ```javascript\n   38  for (var i = 0; i &lt; items.length; i++) {\n   39:     console.log(items[i], i); // log them\n   40  }\n   41  ```\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/less/less.js:\n  128          //commment out these 2 comment if you want the minus sign to be parsed as null -500px\n  129          //stream.backUp(stream.current().length-1);\n  130:         //return ret(null, ch); //console.log( stream.current() );\n  131          return ret(\"number\", \"unit\");\n  132        }else if( /\\/|[\\s\\)]/.test(stream.peek() || stream.eol() || (stream.eatSpace() && stream.peek() == \"/\")) && stream.current().indexOf(\".\") !== -1){\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/sass/sass.js:\n   55  \n   56        /*\n   57:       console.log(\"previousChar: \" + previousChar);\n   58:       console.log(\"nextChar: \" + nextChar);\n   59:       console.log(\"peekChar: \" + peekChar);\n   60:       console.log(\"ending: \" + endingString);\n   61        */\n   62  \n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/smarty/index.html:\n   88  <script>\n   89  function test() {\n   90: 	console.log(\"Smarty 3 permits single curly braces followed by whitespace to NOT slip into Smarty mode.\");\n   91  }\n   92  </script>\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/vb/index.html:\n   22    var i = 0;\n   23    function callback(token, style, lineNo, pos){\n   24: 		//console.log(String(token) + \" \" + String(style) + \" \" + String(lineNo) + \" \" + String(pos));\n   25      var result = [String(token), String(style)];\n   26      if (golden[i][0] != result[0] || golden[i][1] != result[1]){\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/autocomplete.js:\n   53  \n   54    function listen() {\n   55:     console.log('listening to escape events');\n   56      escapeListener = $rootScope.$on('escape-pressed', $scope.toggle);\n   57    }\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/connect.js:\n   24  \n   25    $scope.use = function () {\n   26:     console.log(\"now using\");\n   27      \n   28      $state.transitionTo('home.connect.use', $stateParams);\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/context-controller.js:\n   17  \n   18    $scope.transpose = function () {\n   19:     console.log('transposing');\n   20      $scope.transposed = !$scope.transposed;\n   21    };\n   22  \n   23    $scope.connect = function (item) {\n   24:     // console.log($scope.activeField, $scope.activeDocument._id);\n   25  \n   26      $state.transitionTo('home.connect', {\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/editor.js:\n   33  \n   34    $rootScope.$on('demote', function () {\n   35:     console.log('demote');\n   36    });\n   37    $rootScope.$on('promote', function () {\n   38:     console.log('promote');\n   39    });\n   40    $rootScope.$on('move-right', function () {\n   41:     console.log('move-right');\n   42    });\n   43    $rootScope.$on('move-up', function () {\n   44:     console.log('move-up');\n   45    });\n   46    $rootScope.$on('move-down', function () {\n   47:     console.log('move-down');\n   48    });\n   49    $rootScope.$on('move-left', function () {\n   50:     console.log('move-left');\n   51    });\n   52  \n   ..\n   56      contents.remove('.embedded-context,.CodeMirror');\n   57      var html = elements.html();\n   58:     console.log('Saving', html);\n   59  \n   60      feed.save({\n   ..\n   67  \n   68    $scope.saved = function (err, response) {\n   69:     console.log('saved', err, response);\n   70    };\n   71  \n   ..\n   75  \n   76    $rootScope.$on('embed-field', function (event, field) {\n   77:     console.log('Embedding', field);\n   78      $scope[$scope.activeDocument.fields[field].type](field);\n   79    });\n   ..\n   85      });\n   86      if (node.nodeType !== 3) {\n   87:       console.log(\"Not a text node. Ensuring flattened structure.\", node.parentNode);\n   88        // node = $(node).parentsUntil('.post-body')[0];\n   89        var oneDeep = $(node).parentsUntil('.post-body');\n   ..\n  101          \n  102        } else {\n  103:         console.log(\"Inserting before the selected node\");\n  104         node = node.previousSibling;\n  105        }\n  ...\n  109      \n  110      if (parents.length === 1) {\n  111:       console.log(node.textContent.length);\n  112        if (node.textContent.length === $scope.selection.anchorOffset) {\n  113:         console.log(\"Insert at end of line\");\n  114          var firstParent = $(node).parentsUntil('.post-body')[0];\n  115          $(firstParent).after(newNode);\n  ...\n  120          $(node).wrap(\"<div>\");\n  121          $(remaining).wrap(\"<div>\");\n  122:         console.log(\"Text split at\", $scope.selection.anchorOffset);\n  123        }\n  124      } else {\n  125        $('.post-body').append(newNode);\n  126:       console.log('selection not inside text area');\n  127      }\n  128      if (newNode.nodeType === 3) {\n  ...\n  147      var model;\n  148     if (modelIndex === undefined) {\n  149:       console.log(\"Creating empty model.\");\n  150        model = modelConstructor();\n  151        \n  152        $scope.activeDocument.fields.push(model);\n  153      } else {\n  154:       console.log(\"Using pre-existing model.\");\n  155        model = $scope.activeDocument.fields[modelIndex];\n  156      }\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/spaces.js:\n    6        // $scope.items.push.apply($scope.items, docs);\n    7        $scope.$apply();\n    8:       console.log(\"Retrieved\", docs);\n    9    });\n   10  \n   11    $scope.items = feed.items;\n   12    \n   13:   console.log('loaded feed items', feed.items);\n   14    \n   15  \n   16    $scope.update = function (feedItem) {\n   17:     console.log(JSON.stringify(feedItem, null, 4));\n   18      feed.update(feedItem);\n   19    };\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/viewer.js:\n    1  angular.module('system').controller('viewer', ['$scope', 'demoData',\n    2    function ($scope, demoData) {\n    3:     console.log('data from promise', demoData.data);\n    4    angular.extend($scope, demoData.data);\n    5  }]);\n\n/Users/ssquire/Documents/projects/liveinterface/directives/angular-content.js:\n    8        var documentIndex = $scope.$eval($attrs.documentIndex);\n    9  \n   10:       console.log(\"linking run angular\", documentIndex);\n   11        var model = $scope.items[documentIndex];\n   12        \n   ..\n   17        var newContent = $.trim(template);\n   18        $compile(newContent)(subDocumentScope, function (rendered) {\n   19:         console.log(rendered);\n   20          $element.append(rendered);\n   21:         console.log(\"DONE angular content\", rendered);\n   22          \n   23          \n\n/Users/ssquire/Documents/projects/liveinterface/directives/contenteditable.js:\n   12        \n   13        $element.on('keydown', function () {\n   14:         console.log('change');\n   15        });\n   16  \n\n/Users/ssquire/Documents/projects/liveinterface/directives/context.js:\n    4    function importTemplate(url) {\n    5      $http.get(url).then(function (templateData) {\n    6:       console.log(\"Imported template for\", url);\n    7        $templateCache.put(url, templateData.data);\n    8      });\n    .\n   36          instanceName: $element.attr('href')\n   37        };\n   38:       console.log(\"Active Document is\", $scope.activeDocument);\n   39        model = $scope.activeDocument.fields[metadata.fieldIndex];\n   40:       console.log('Encountered context', model);\n   41  \n   42        contextTemplateUrl = 'views/' + metadata.kind + '.html';\n   ..\n   56          // wait for all the other bindings in the template have finished\n   57          $element.after(embeddedContent);\n   58:         // console.log(\"DONE context insertion\", embeddedContent.html());\n   59          var focusNodes = embeddedContent.find('.focus');\n   60  \n   ..\n   67        \n   68  \n   69:       // console.log(contextTemplateUrl);\n   70:       // console.log('Got template HTML', templateHtml);\n   71      }\n   72    };\n\n/Users/ssquire/Documents/projects/liveinterface/directives/follow.js:\n   16        pos = _.pick(pos, ['left', 'top']);\n   17        \n   18:       // console.log(\"Keypress:\", $(this).text(), sel, sel.focusNode, $(sel.focusNode.parentElement).position());\n   19        var rightEdge = pos.left + dropdown.width();\n   20        \n   ..\n   22        \n   23        if (rightEdge >= windowWidth) {\n   24:         console.log(\"Over the edge,\", rightEdge, windowWidth, pos);\n   25          var newLeft = pos.left - (rightEdge - windowWidth);\n   26          pos.left = newLeft;\n\n/Users/ssquire/Documents/projects/liveinterface/directives/keypress.js:\n   40        var index = event.keyCode - 48;\n   41        var selected = $element.find(validOptions).get(index - 1)\n   42:       console.log(index, selected);\n   43        selected.focus();\n   44        selected.click();\n   ..\n   53  return {\n   54    link: function ($scope, $element, $attrs) {\n   55:     var settings = $scope.$eval($attrs.directionalFocus); console.log(settings);\n   56      var validElement = settings.container;\n   57      var validItems = settings.items;\n\n/Users/ssquire/Documents/projects/liveinterface/repositories/feed.js:\n   22        docs.forEach(function (doc) {\n   23          if (self.ids.hasOwnProperty(doc._id)) {\n   24:           console.log(\"Change to existing document:\", doc._id);\n   25:           // console.log('already existing doc', doc, doc._id);\n   26            $.extend(true, self.ids[doc._id], doc);\n   27  \n   ..\n   36        \n   37        var opts = {continuous: true, complete: function (err) {\n   38:         // console.log('complete handler', err)\n   39        }};\n   40        db.replicate.to(remoteCouch, opts);\n   ..\n   59            continuous: true,\n   60            onChange: function(change) {\n   61: //            console.log('change occurred', change.doc);\n   62              if (!change.doc._deleted) {\n   63                self.addition([change.doc])\n   ..\n   76  \n   77      self.update = function (feedItem) {\n   78:       console.log('Updated', feedItem);\n   79        var rev = feedItem._rev;\n   80        db.remove(feedItem);\n   81        var revNumber = (parseInt(feedItem._rev.substr(0, 2), 10) + 1);\n   82        feedItem._rev = revNumber + feedItem._rev.substring(feedItem._rev.indexOf(\"-\"));\n   83:       console.log(revNumber, 'From', rev, 'to', feedItem._rev);\n   84        db.put(feedItem, {}, function (err) {\n   85:         console.log(err);\n   86        });\n   87      };\n\n60 matches across 21 files\n\n\nSearching 299 files for \"console.log\"\n\n/Users/ssquire/Documents/projects/liveinterface/components/angular/angular.js:\n 3110   * @param {object} document jQuery wrapped document.\n 3111   * @param {function()} XHR XMLHttpRequest constructor.\n 3112:  * @param {object} $log console.log or an object with the same interface.\n 3113   * @param {object} $sniffer $sniffer service\n 3114   */\n ....\n 5920      function consoleLog(type) {\n 5921        var console = $window.console || {},\n 5922:           logFn = console[type] || console.log || noop;\n 5923  \n 5924        if (logFn.apply) {\n ....\n 5933  \n 5934        // we are IE which either doesn't have window.console => this is noop and we do nothing,\n 5935:       // or we are IE where console.log doesn't have apply so we log at least first 2 args\n 5936        return function(arg1, arg2) {\n 5937          logFn(arg1, arg2);\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/addon/search/searchcursor.js:\n  107        for (;;) {\n  108          if (this.pos = this.matches(reverse, pos)) {\n  109:           if (!this.pos.from || !this.pos.to) { console.log(this.matches, this.pos); }\n  110            this.atOccurrence = true;\n  111            return this.pos.match || true;\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/addon/tern/tern.js:\n  591          });\n  592        } else if (data.type == \"debug\") {\n  593:         console.log(data.message);\n  594        } else if (data.id && pending[data.id]) {\n  595          pending[data.id](data.err, data.body);\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/diff/index.html:\n   29  -        autoMatchBrackets: true\n   30  +        autoMatchBrackets: true,\n   31: +      onGutterClick: function(x){console.log(x);}\n   32         });\n   33       </script>\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/gfm/index.html:\n   37  ```javascript\n   38  for (var i = 0; i &lt; items.length; i++) {\n   39:     console.log(items[i], i); // log them\n   40  }\n   41  ```\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/less/less.js:\n  128          //commment out these 2 comment if you want the minus sign to be parsed as null -500px\n  129          //stream.backUp(stream.current().length-1);\n  130:         //return ret(null, ch); //console.log( stream.current() );\n  131          return ret(\"number\", \"unit\");\n  132        }else if( /\\/|[\\s\\)]/.test(stream.peek() || stream.eol() || (stream.eatSpace() && stream.peek() == \"/\")) && stream.current().indexOf(\".\") !== -1){\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/sass/sass.js:\n   55  \n   56        /*\n   57:       console.log(\"previousChar: \" + previousChar);\n   58:       console.log(\"nextChar: \" + nextChar);\n   59:       console.log(\"peekChar: \" + peekChar);\n   60:       console.log(\"ending: \" + endingString);\n   61        */\n   62  \n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/smarty/index.html:\n   88  <script>\n   89  function test() {\n   90: 	console.log(\"Smarty 3 permits single curly braces followed by whitespace to NOT slip into Smarty mode.\");\n   91  }\n   92  </script>\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/vb/index.html:\n   22    var i = 0;\n   23    function callback(token, style, lineNo, pos){\n   24: 		//console.log(String(token) + \" \" + String(style) + \" \" + String(lineNo) + \" \" + String(pos));\n   25      var result = [String(token), String(style)];\n   26      if (golden[i][0] != result[0] || golden[i][1] != result[1]){\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/connect.js:\n   24  \n   25    $scope.use = function () {\n   26:     console.log(\"now using\");\n   27      \n   28      $state.transitionTo('home.connect.use', $stateParams);\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/context-controller.js:\n   17  \n   18    $scope.transpose = function () {\n   19:     console.log('transposing');\n   20      $scope.transposed = !$scope.transposed;\n   21    };\n   22  \n   23    $scope.connect = function (item) {\n   24:     // console.log($scope.activeField, $scope.activeDocument._id);\n   25  \n   26      $state.transitionTo('home.connect', {\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/editor.js:\n   33  \n   34    $rootScope.$on('demote', function () {\n   35:     console.log('demote');\n   36    });\n   37    $rootScope.$on('promote', function () {\n   38:     console.log('promote');\n   39    });\n   40    $rootScope.$on('move-right', function () {\n   41:     console.log('move-right');\n   42    });\n   43    $rootScope.$on('move-up', function () {\n   44:     console.log('move-up');\n   45    });\n   46    $rootScope.$on('move-down', function () {\n   47:     console.log('move-down');\n   48    });\n   49    $rootScope.$on('move-left', function () {\n   50:     console.log('move-left');\n   51    });\n   52  \n   ..\n   56      contents.remove('.embedded-context,.CodeMirror');\n   57      var html = elements.html();\n   58:     console.log('Saving', html);\n   59  \n   60      feed.save({\n   ..\n   67  \n   68    $scope.saved = function (err, response) {\n   69:     console.log('saved', err, response);\n   70    };\n   71  \n   ..\n   75  \n   76    $rootScope.$on('embed-field', function (event, field) {\n   77:     console.log('Embedding', field);\n   78      $scope[$scope.activeDocument.fields[field].type](field);\n   79    });\n   ..\n   85      });\n   86      if (node.nodeType !== 3) {\n   87:       console.log(\"Not a text node. Ensuring flattened structure.\", node.parentNode);\n   88        // node = $(node).parentsUntil('.post-body')[0];\n   89        var oneDeep = $(node).parentsUntil('.post-body');\n   ..\n  101          \n  102        } else {\n  103:         console.log(\"Inserting before the selected node\");\n  104         node = node.previousSibling;\n  105        }\n  ...\n  109      \n  110      if (parents.length === 1) {\n  111:       console.log(node.textContent.length);\n  112        if (node.textContent.length === $scope.selection.anchorOffset) {\n  113:         console.log(\"Insert at end of line\");\n  114          var firstParent = $(node).parentsUntil('.post-body')[0];\n  115          $(firstParent).after(newNode);\n  ...\n  120          $(node).wrap(\"<div>\");\n  121          $(remaining).wrap(\"<div>\");\n  122:         console.log(\"Text split at\", $scope.selection.anchorOffset);\n  123        }\n  124      } else {\n  125        $('.post-body').append(newNode);\n  126:       console.log('selection not inside text area');\n  127      }\n  128      if (newNode.nodeType === 3) {\n  ...\n  147      var model;\n  148     if (modelIndex === undefined) {\n  149:       console.log(\"Creating empty model.\");\n  150        model = modelConstructor();\n  151        \n  152        $scope.activeDocument.fields.push(model);\n  153      } else {\n  154:       console.log(\"Using pre-existing model.\");\n  155        model = $scope.activeDocument.fields[modelIndex];\n  156      }\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/spaces.js:\n    6        // $scope.items.push.apply($scope.items, docs);\n    7        $scope.$apply();\n    8:       console.log(\"Retrieved\", docs);\n    9    });\n   10  \n   11    $scope.items = feed.items;\n   12    \n   13:   console.log('loaded feed items', feed.items);\n   14    \n   15  \n   16    $scope.update = function (feedItem) {\n   17:     console.log(JSON.stringify(feedItem, null, 4));\n   18      feed.update(feedItem);\n   19    };\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/viewer.js:\n    1  angular.module('system').controller('viewer', ['$scope', 'demoData',\n    2    function ($scope, demoData) {\n    3:     console.log('data from promise', demoData.data);\n    4    angular.extend($scope, demoData.data);\n    5  }]);\n\n/Users/ssquire/Documents/projects/liveinterface/directives/angular-content.js:\n    8        var documentIndex = $scope.$eval($attrs.documentIndex);\n    9  \n   10:       console.log(\"linking run angular\", documentIndex);\n   11        var model = $scope.items[documentIndex];\n   12        \n   ..\n   17        var newContent = $.trim(template);\n   18        $compile(newContent)(subDocumentScope, function (rendered) {\n   19:         console.log(rendered);\n   20          $element.append(rendered);\n   21:         console.log(\"DONE angular content\", rendered);\n   22          \n   23          \n\n/Users/ssquire/Documents/projects/liveinterface/directives/contenteditable.js:\n   12        \n   13        $element.on('keydown', function () {\n   14:         console.log('change');\n   15        });\n   16  \n\n/Users/ssquire/Documents/projects/liveinterface/directives/context.js:\n    4    function importTemplate(url) {\n    5      $http.get(url).then(function (templateData) {\n    6:       console.log(\"Imported template for\", url);\n    7        $templateCache.put(url, templateData.data);\n    8      });\n    .\n   36          instanceName: $element.attr('href')\n   37        };\n   38:       console.log(\"Active Document is\", $scope.activeDocument);\n   39        model = $scope.activeDocument.fields[metadata.fieldIndex];\n   40:       console.log('Encountered context', model);\n   41  \n   42        contextTemplateUrl = 'views/' + metadata.kind + '.html';\n   ..\n   56          // wait for all the other bindings in the template have finished\n   57          $element.after(embeddedContent);\n   58:         // console.log(\"DONE context insertion\", embeddedContent.html());\n   59          var focusNodes = embeddedContent.find('.focus');\n   60  \n   ..\n   67        \n   68  \n   69:       // console.log(contextTemplateUrl);\n   70:       // console.log('Got template HTML', templateHtml);\n   71      }\n   72    };\n\n/Users/ssquire/Documents/projects/liveinterface/directives/follow.js:\n   16        pos = _.pick(pos, ['left', 'top']);\n   17        \n   18:       // console.log(\"Keypress:\", $(this).text(), sel, sel.focusNode, $(sel.focusNode.parentElement).position());\n   19        var rightEdge = pos.left + dropdown.width();\n   20        \n   ..\n   22        \n   23        if (rightEdge >= windowWidth) {\n   24:         console.log(\"Over the edge,\", rightEdge, windowWidth, pos);\n   25          var newLeft = pos.left - (rightEdge - windowWidth);\n   26          pos.left = newLeft;\n\n/Users/ssquire/Documents/projects/liveinterface/directives/keypress.js:\n   40        var index = event.keyCode - 48;\n   41        var selected = $element.find(validOptions).get(index - 1)\n   42:       console.log(index, selected);\n   43        selected.focus();\n   44        selected.click();\n   ..\n   53  return {\n   54    link: function ($scope, $element, $attrs) {\n   55:     var settings = $scope.$eval($attrs.directionalFocus); console.log(settings);\n   56      var validElement = settings.container;\n   57      var validItems = settings.items;\n\n/Users/ssquire/Documents/projects/liveinterface/repositories/feed.js:\n   22        docs.forEach(function (doc) {\n   23          if (self.ids.hasOwnProperty(doc._id)) {\n   24:           console.log(\"Change to existing document:\", doc._id);\n   25:           // console.log('already existing doc', doc, doc._id);\n   26            $.extend(true, self.ids[doc._id], doc);\n   27  \n   ..\n   36        \n   37        var opts = {continuous: true, complete: function (err) {\n   38:         // console.log('complete handler', err)\n   39        }};\n   40        db.replicate.to(remoteCouch, opts);\n   ..\n   59            continuous: true,\n   60            onChange: function(change) {\n   61: //            console.log('change occurred', change.doc);\n   62              if (!change.doc._deleted) {\n   63                self.addition([change.doc])\n   ..\n   76  \n   77      self.update = function (feedItem) {\n   78:       console.log('Updated', feedItem);\n   79        var rev = feedItem._rev;\n   80        db.remove(feedItem);\n   81        var revNumber = (parseInt(feedItem._rev.substr(0, 2), 10) + 1);\n   82        feedItem._rev = revNumber + feedItem._rev.substring(feedItem._rev.indexOf(\"-\"));\n   83:       console.log(revNumber, 'From', rev, 'to', feedItem._rev);\n   84        db.put(feedItem, {}, function (err) {\n   85:         console.log(err);\n   86        });\n   87      };\n\n59 matches across 20 files\n\n\nSearching 299 files for \"console.log\"\n\n/Users/ssquire/Documents/projects/liveinterface/components/angular/angular.js:\n 3110   * @param {object} document jQuery wrapped document.\n 3111   * @param {function()} XHR XMLHttpRequest constructor.\n 3112:  * @param {object} $log console.log or an object with the same interface.\n 3113   * @param {object} $sniffer $sniffer service\n 3114   */\n ....\n 5920      function consoleLog(type) {\n 5921        var console = $window.console || {},\n 5922:           logFn = console[type] || console.log || noop;\n 5923  \n 5924        if (logFn.apply) {\n ....\n 5933  \n 5934        // we are IE which either doesn't have window.console => this is noop and we do nothing,\n 5935:       // or we are IE where console.log doesn't have apply so we log at least first 2 args\n 5936        return function(arg1, arg2) {\n 5937          logFn(arg1, arg2);\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/addon/search/searchcursor.js:\n  107        for (;;) {\n  108          if (this.pos = this.matches(reverse, pos)) {\n  109:           if (!this.pos.from || !this.pos.to) { console.log(this.matches, this.pos); }\n  110            this.atOccurrence = true;\n  111            return this.pos.match || true;\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/addon/tern/tern.js:\n  591          });\n  592        } else if (data.type == \"debug\") {\n  593:         console.log(data.message);\n  594        } else if (data.id && pending[data.id]) {\n  595          pending[data.id](data.err, data.body);\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/diff/index.html:\n   29  -        autoMatchBrackets: true\n   30  +        autoMatchBrackets: true,\n   31: +      onGutterClick: function(x){console.log(x);}\n   32         });\n   33       </script>\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/gfm/index.html:\n   37  ```javascript\n   38  for (var i = 0; i &lt; items.length; i++) {\n   39:     console.log(items[i], i); // log them\n   40  }\n   41  ```\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/less/less.js:\n  128          //commment out these 2 comment if you want the minus sign to be parsed as null -500px\n  129          //stream.backUp(stream.current().length-1);\n  130:         //return ret(null, ch); //console.log( stream.current() );\n  131          return ret(\"number\", \"unit\");\n  132        }else if( /\\/|[\\s\\)]/.test(stream.peek() || stream.eol() || (stream.eatSpace() && stream.peek() == \"/\")) && stream.current().indexOf(\".\") !== -1){\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/sass/sass.js:\n   55  \n   56        /*\n   57:       console.log(\"previousChar: \" + previousChar);\n   58:       console.log(\"nextChar: \" + nextChar);\n   59:       console.log(\"peekChar: \" + peekChar);\n   60:       console.log(\"ending: \" + endingString);\n   61        */\n   62  \n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/smarty/index.html:\n   88  <script>\n   89  function test() {\n   90: 	console.log(\"Smarty 3 permits single curly braces followed by whitespace to NOT slip into Smarty mode.\");\n   91  }\n   92  </script>\n\n/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/vb/index.html:\n   22    var i = 0;\n   23    function callback(token, style, lineNo, pos){\n   24: 		//console.log(String(token) + \" \" + String(style) + \" \" + String(lineNo) + \" \" + String(pos));\n   25      var result = [String(token), String(style)];\n   26      if (golden[i][0] != result[0] || golden[i][1] != result[1]){\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/connect.js:\n   24  \n   25    $scope.use = function () {\n   26:     console.log(\"now using\");\n   27      \n   28      $state.transitionTo('home.connect.use', $stateParams);\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/context-controller.js:\n   17  \n   18    $scope.transpose = function () {\n   19:     console.log('transposing');\n   20      $scope.transposed = !$scope.transposed;\n   21    };\n   22  \n   23    $scope.connect = function (item) {\n   24:     // console.log($scope.activeField, $scope.activeDocument._id);\n   25  \n   26      $state.transitionTo('home.connect', {\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/editor.js:\n   33  \n   34    $rootScope.$on('demote', function () {\n   35:     console.log('demote');\n   36    });\n   37    $rootScope.$on('promote', function () {\n   38:     console.log('promote');\n   39    });\n   40    $rootScope.$on('move-right', function () {\n   41:     console.log('move-right');\n   42    });\n   43    $rootScope.$on('move-up', function () {\n   44:     console.log('move-up');\n   45    });\n   46    $rootScope.$on('move-down', function () {\n   47:     console.log('move-down');\n   48    });\n   49    $rootScope.$on('move-left', function () {\n   50:     console.log('move-left');\n   51    });\n   52  \n   ..\n   66  \n   67    $scope.saved = function (err, response) {\n   68:     console.log('saved', err, response);\n   69    };\n   70  \n   ..\n   74  \n   75    $rootScope.$on('embed-field', function (event, field) {\n   76:     console.log('Embedding', field);\n   77      $scope[$scope.activeDocument.fields[field].type](field);\n   78    });\n   ..\n   84      });\n   85      if (node.nodeType !== 3) {\n   86:       console.log(\"Not a text node. Ensuring flattened structure.\", node.parentNode);\n   87        // node = $(node).parentsUntil('.post-body')[0];\n   88        var oneDeep = $(node).parentsUntil('.post-body');\n   ..\n  100          \n  101        } else {\n  102:         console.log(\"Inserting before the selected node\");\n  103         node = node.previousSibling;\n  104        }\n  ...\n  108      \n  109      if (parents.length === 1) {\n  110:       console.log(node.textContent.length);\n  111        if (node.textContent.length === $scope.selection.anchorOffset) {\n  112:         console.log(\"Insert at end of line\");\n  113          var firstParent = $(node).parentsUntil('.post-body')[0];\n  114          $(firstParent).after(newNode);\n  ...\n  119          $(node).wrap(\"<div>\");\n  120          $(remaining).wrap(\"<div>\");\n  121:         console.log(\"Text split at\", $scope.selection.anchorOffset);\n  122        }\n  123      } else {\n  124        $('.post-body').append(newNode);\n  125:       console.log('selection not inside text area');\n  126      }\n  127      if (newNode.nodeType === 3) {\n  ...\n  146      var model;\n  147     if (modelIndex === undefined) {\n  148:       console.log(\"Creating empty model.\");\n  149        model = modelConstructor();\n  150        \n  151        $scope.activeDocument.fields.push(model);\n  152      } else {\n  153:       console.log(\"Using pre-existing model.\");\n  154        model = $scope.activeDocument.fields[modelIndex];\n  155      }\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/spaces.js:\n    6        // $scope.items.push.apply($scope.items, docs);\n    7        $scope.$apply();\n    8:       console.log(\"Retrieved\", docs);\n    9    });\n   10  \n   11    $scope.items = feed.items;\n   12    \n   13:   console.log('loaded feed items', feed.items);\n   14    \n   15  \n   16    $scope.update = function (feedItem) {\n   17:     console.log(JSON.stringify(feedItem, null, 4));\n   18      feed.update(feedItem);\n   19    };\n\n/Users/ssquire/Documents/projects/liveinterface/controllers/viewer.js:\n    1  angular.module('system').controller('viewer', ['$scope', 'demoData',\n    2    function ($scope, demoData) {\n    3:     console.log('data from promise', demoData.data);\n    4    angular.extend($scope, demoData.data);\n    5  }]);\n\n/Users/ssquire/Documents/projects/liveinterface/directives/angular-content.js:\n    8        var documentIndex = $scope.$eval($attrs.documentIndex);\n    9  \n   10:       console.log(\"linking run angular\", documentIndex);\n   11        var model = $scope.items[documentIndex];\n   12        \n   ..\n   17        var newContent = $.trim(template);\n   18        $compile(newContent)(subDocumentScope, function (rendered) {\n   19:         console.log(rendered);\n   20          $element.append(rendered);\n   21:         console.log(\"DONE angular content\", rendered);\n   22          \n   23          \n\n/Users/ssquire/Documents/projects/liveinterface/directives/contenteditable.js:\n   12        \n   13        $element.on('keydown', function () {\n   14:         console.log('change');\n   15        });\n   16  \n\n/Users/ssquire/Documents/projects/liveinterface/directives/context.js:\n    4    function importTemplate(url) {\n    5      $http.get(url).then(function (templateData) {\n    6:       console.log(\"Imported template for\", url);\n    7        $templateCache.put(url, templateData.data);\n    8      });\n    .\n   36          instanceName: $element.attr('href')\n   37        };\n   38:       console.log(\"Active Document is\", $scope.activeDocument);\n   39        model = $scope.activeDocument.fields[metadata.fieldIndex];\n   40:       console.log('Encountered context', model);\n   41  \n   42        contextTemplateUrl = 'views/' + metadata.kind + '.html';\n   ..\n   56          // wait for all the other bindings in the template have finished\n   57          $element.after(embeddedContent);\n   58:         // console.log(\"DONE context insertion\", embeddedContent.html());\n   59          var focusNodes = embeddedContent.find('.focus');\n   60  \n   ..\n   67        \n   68  \n   69:       // console.log(contextTemplateUrl);\n   70:       // console.log('Got template HTML', templateHtml);\n   71      }\n   72    };\n\n/Users/ssquire/Documents/projects/liveinterface/directives/follow.js:\n   16        pos = _.pick(pos, ['left', 'top']);\n   17        \n   18:       // console.log(\"Keypress:\", $(this).text(), sel, sel.focusNode, $(sel.focusNode.parentElement).position());\n   19        var rightEdge = pos.left + dropdown.width();\n   20        \n   ..\n   22        \n   23        if (rightEdge >= windowWidth) {\n   24:         console.log(\"Over the edge,\", rightEdge, windowWidth, pos);\n   25          var newLeft = pos.left - (rightEdge - windowWidth);\n   26          pos.left = newLeft;\n\n/Users/ssquire/Documents/projects/liveinterface/directives/keypress.js:\n   40        var index = event.keyCode - 48;\n   41        var selected = $element.find(validOptions).get(index - 1)\n   42:       console.log(index, selected);\n   43        selected.focus();\n   44        selected.click();\n   ..\n   53  return {\n   54    link: function ($scope, $element, $attrs) {\n   55:     var settings = $scope.$eval($attrs.directionalFocus); console.log(settings);\n   56      var validElement = settings.container;\n   57      var validItems = settings.items;\n\n/Users/ssquire/Documents/projects/liveinterface/repositories/feed.js:\n   22        docs.forEach(function (doc) {\n   23          if (self.ids.hasOwnProperty(doc._id)) {\n   24:           console.log(\"Change to existing document:\", doc._id);\n   25:           // console.log('already existing doc', doc, doc._id);\n   26            $.extend(true, self.ids[doc._id], doc);\n   27  \n   ..\n   36        \n   37        var opts = {continuous: true, complete: function (err) {\n   38:         // console.log('complete handler', err)\n   39        }};\n   40        db.replicate.to(remoteCouch, opts);\n   ..\n   59            continuous: true,\n   60            onChange: function(change) {\n   61: //            console.log('change occurred', change.doc);\n   62              if (!change.doc._deleted) {\n   63                self.addition([change.doc])\n   ..\n   76  \n   77      self.update = function (feedItem) {\n   78:       console.log('Updated', feedItem);\n   79        var rev = feedItem._rev;\n   80        db.remove(feedItem);\n   81        var revNumber = (parseInt(feedItem._rev.substr(0, 2), 10) + 1);\n   82        feedItem._rev = revNumber + feedItem._rev.substring(feedItem._rev.indexOf(\"-\"));\n   83:       console.log(revNumber, 'From', rev, 'to', feedItem._rev);\n   84        db.put(feedItem, {}, function (err) {\n   85:         console.log(err);\n   86        });\n   87      };\n\n58 matches across 20 files\n",
+			"file": "styles/tree.css",
 			"settings":
 			{
-				"buffer_size": 49247,
+				"buffer_size": 121,
 				"line_ending": "Unix",
-				"name": "Find Results",
-				"scratch": true
+				"name": ".tree li {"
+			}
+		},
+		{
+			"file": "directives/context.js",
+			"settings":
+			{
+				"buffer_size": 2279,
+				"line_ending": "Unix"
 			}
 		},
 		{
-			"file": "livingdocuments.sublime-project",
+			"file": "controllers/context-controller.js",
 			"settings":
 			{
-				"buffer_size": 131,
+				"buffer_size": 12793,
 				"line_ending": "Unix"
 			}
 		}
@@ -238,6 +269,14 @@
 				"File: Close All"
 			],
 			[
+				"close ",
+				"File: Close All"
+			],
+			[
+				"closeall",
+				"File: Close All"
+			],
+			[
 				"close",
 				"File: Close All"
 			],
@@ -258,7 +297,7 @@
 				"Set Syntax: Ruby"
 			]
 		],
-		"width": 467.0
+		"width": 575.0
 	},
 	"console":
 	{
@@ -275,46 +314,76 @@
 	},
 	"file_history":
 	[
-		"/Users/ssquire/Documents/projects/liveinterface/livingdocuments.sublime-project",
-		"/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/perl/perl.js",
-		"/Users/ssquire/Documents/projects/liveinterface/controllers/spaces.js",
-		"/Users/ssquire/Documents/projects/liveinterface/directives/angular-content.js",
-		"/Users/ssquire/Documents/projects/liveinterface/styles/spaces.css",
+		"/Users/ssquire/Documents/projects/liveinterface/views/structural-tree-view.html",
+		"/Users/ssquire/Documents/projects/liveinterface/controllers/dataobject.js",
+		"/Users/ssquire/Documents/projects/liveinterface/styles/main.css",
+		"/Users/ssquire/Documents/projects/liveinterface/styles/feed.css",
+		"/Users/ssquire/Documents/projects/liveinterface/index.html",
+		"/Users/ssquire/Documents/projects/liveinterface/app.js",
 		"/Users/ssquire/Documents/projects/liveinterface/controllers/editor.js",
-		"/Users/ssquire/Documents/projects/liveinterface/repositories/feed.js",
+		"/Users/ssquire/Documents/projects/liveinterface/views/data.html",
+		"/Users/ssquire/Documents/projects/liveinterface/presentation/index.html",
+		"/Users/ssquire/Documents/projects/liveinterface/models/bucket.js",
+		"/Users/ssquire/Documents/projects/liveinterface/controllers/autocomplete.js",
+		"/Users/ssquire/Documents/projects/liveinterface/services/buckets.js",
 		"/Users/ssquire/Documents/projects/liveinterface/directives/context.js",
+		"/Users/ssquire/Documents/projects/liveinterface/views/list.html",
+		"/Users/ssquire/Documents/projects/liveinterface/bucket.js",
+		"/Users/ssquire/Documents/projects/liveinterface/models/list.js",
+		"/Users/ssquire/Documents/projects/liveinterface/views/code.html",
+		"/Users/ssquire/Documents/projects/liveinterface/-",
+		"/Users/ssquire/Documents/projects/liveinterface/utils/analysis.js",
+		"/Users/ssquire/Documents/projects/liveinterface/repositories/shelf.js",
+		"/Users/ssquire/Documents/projects/liveinterface/controllers/sidebar.js",
+		"/Users/ssquire/Documents/projects/liveinterface/directives/angular-content.js",
+		"/Users/ssquire/Documents/projects/liveinterface/directives/sidebar.js",
+		"/Users/ssquire/Documents/projects/liveinterface/views/autocomplete.html",
+		"/Users/ssquire/Documents/projects/liveinterface/directives/focus-when.js",
+		"/Users/ssquire/Documents/projects/liveinterface/views/home.html",
+		"/Users/ssquire/Documents/projects/liveinterface/views/editor.html",
+		"/Users/ssquire/Documents/projects/liveinterface/repositories/feed.js",
 		"/Users/ssquire/Documents/projects/liveinterface/controllers/context-controller.js",
+		"/Users/ssquire/Documents/projects/liveinterface/directives/screenshot.js",
+		"/Users/ssquire/Documents/projects/liveinterface/controllers/shelf.js",
+		"/Users/ssquire/Documents/projects/liveinterface/views/shelf.html",
 		"/Users/ssquire/Documents/projects/liveinterface/views/spaces.html",
-		"/Users/ssquire/Documents/projects/liveinterface/views/editor.html",
-		"/Users/ssquire/Documents/projects/liveinterface/styles/main.css",
-		"/Users/ssquire/Documents/projects/liveinterface/styles/connect.css",
+		"/Users/ssquire/Documents/projects/liveinterface/styles/spaces.css",
+		"/Users/ssquire/Documents/projects/liveinterface/views/embed.html",
 		"/Users/ssquire/Documents/projects/liveinterface/controllers/embed.js",
-		"/Users/ssquire/Documents/projects/liveinterface/controllers/autocomplete.js",
+		"/Users/ssquire/Documents/projects/liveinterface/views/demo.html",
+		"/Users/ssquire/Documents/projects/liveinterface/controllers/spaces.js",
+		"/Users/ssquire/Documents/projects/liveinterface/controllers/home.js",
+		"/Users/ssquire/Documents/projects/liveinterface/views/target.html",
+		"/Users/ssquire/Documents/projects/liveinterface/views/sidebar.html",
+		"/Users/ssquire/Documents/projects/liveinterface/repositories/document.js",
+		"/Users/ssquire/Documents/projects/liveinterface/bucket",
+		"/Users/ssquire/Documents/projects/liveinterface/example.json",
+		"/Users/ssquire/Documents/projects/liveinterface/livingsystem.sublime-project",
+		"/Users/ssquire/Documents/projects/liveinterface/models/code.js",
+		"/Users/ssquire/Documents/projects/liveinterface/components/ui-codemirror/ui-codemirror.js",
+		"/Users/ssquire/Documents/projects/liveinterface/directives/ng-model-onblur.js",
+		"/Users/ssquire/Documents/projects/liveinterface/directives/keypress.js",
+		"/Users/ssquire/Documents/projects/liveinterface/styles/action-dropdown.css",
+		"/Users/ssquire/Documents/projects/liveinterface/services/dependency-tree-generator.js",
+		"/Users/ssquire/Documents/projects/liveinterface/styles/code-context.css",
+		"/Users/ssquire/Documents/projects/liveinterface/views/connect.html",
+		"/Users/ssquire/Documents/projects/liveinterface/views/connect-picker.html",
+		"/Users/ssquire/Documents/projects/liveinterface/controllers/connect.js",
+		"/Users/ssquire/Documents/projects/liveinterface/directives/contenteditable.js",
+		"/Users/ssquire/Documents/projects/liveinterface/components/angular-ui-codemirror/ui-codemirror.js",
+		"/Users/ssquire/Documents/projects/liveinterface/directives/iframe.js",
+		"/Users/ssquire/Documents/projects/liveinterface/livingsystem.sublime-workspace",
+		"/Users/ssquire/Documents/projects/liveinterface/livingdocuments.sublime-project",
+		"/Users/ssquire/Documents/projects/liveinterface/components/codemirror/mode/perl/perl.js",
+		"/Users/ssquire/Documents/projects/liveinterface/styles/connect.css",
 		"/Users/ssquire/Documents/projects/liveinterface/services/keybindings.js",
 		"/Users/ssquire/Documents/projects/liveinterface/directives/follow.js",
-		"/Users/ssquire/Documents/projects/liveinterface/views/embed.html",
-		"/Users/ssquire/Documents/projects/liveinterface/views/list.html",
-		"/Users/ssquire/Documents/projects/liveinterface/controllers/dataobject.js",
 		"/Users/ssquire/Documents/projects/liveinterface/directives/when-blur.js",
-		"/Users/ssquire/Documents/projects/liveinterface/directives/contenteditable.js",
-		"/Users/ssquire/Documents/projects/liveinterface/directives/keypress.js",
-		"/Users/ssquire/Documents/projects/liveinterface/index.html",
-		"/Users/ssquire/Documents/projects/liveinterface/views/connect.html",
-		"/Users/ssquire/Documents/projects/liveinterface/views/autocomplete.html",
 		"/Users/ssquire/Documents/projects/liveinterface/styles/autocomplete.css",
-		"/Users/ssquire/Documents/projects/liveinterface/controllers/connect.js",
-		"/Users/ssquire/Documents/projects/liveinterface/views/target.html",
-		"/Users/ssquire/Documents/projects/liveinterface/models/list.js",
-		"/Users/ssquire/Documents/projects/liveinterface/app.js",
-		"/Users/ssquire/Documents/projects/liveinterface/repositories/document.js",
-		"/Users/ssquire/Documents/projects/liveinterface/views/home.html",
-		"/Users/ssquire/Documents/projects/liveinterface/views/demo.html",
 		"/Users/ssquire/Documents/projects/liveinterface/controllers/viewer.js",
-		"/Users/ssquire/Documents/projects/liveinterface/example.json",
 		"/Users/ssquire/Documents/projects/liveinterface/directives/interested-in-focus.js",
 		"/Users/ssquire/Documents/projects/liveinterface/directives/packery.js",
 		"/Users/ssquire/Documents/projects/liveinterface/styles/embedded.css",
-		"/Users/ssquire/Documents/projects/liveinterface/directives/focus-when.js",
 		"/Users/ssquire/Documents/projects/liveinterface/style.css",
 		"/Users/ssquire/Documents/projects/liveinterface/editor.js",
 		"/Users/ssquire/Documents/flourish/mvndeps",
@@ -372,37 +441,7 @@
 		"/Users/ssquire/Documents/krypton/test/frontend/js/spec/articleFieldsSpec.js",
 		"/Users/ssquire/Documents/krypton/resources/public/scripts/app/article/articleSectionVM.js",
 		"/Users/ssquire/Documents/krypton/resources/public/scripts/app/article/articles.js",
-		"/Users/ssquire/Documents/krypton/resources/templates/scripts/new-article.html",
-		"/Users/ssquire/Documents/krypton/test/frontend/feature/article.clj",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-52.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-53.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-51.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-49.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-50.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-54.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-48.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-55.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-47.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-46.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-56.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-57.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-45.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-60.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-59.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-58.json",
-		"/Users/ssquire/Documents/krypton/resources/public/scripts/app/article/articleVM.js",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-44.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-43.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-42.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-40.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-39.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-38.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-28.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-26.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-25.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-22.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-19.json",
-		"/Users/ssquire/Documents/krypton/db/import/deploy/articles/english/en/article-16.json"
+		"/Users/ssquire/Documents/krypton/resources/templates/scripts/new-article.html"
 	],
 	"find":
 	{
@@ -423,6 +462,66 @@
 		"case_sensitive": false,
 		"find_history":
 		[
+			"    <a href=\"\" rel=\"embedded\" data-kind=\"jsonlist\" data-id=\"4\"></a>",
+			"fredChildren",
+			"parents",
+			"swap",
+			"newChildren",
+			"a",
+			"deleteLonelyParents",
+			"collapse",
+			"(a",
+			"a)",
+			"a ",
+			"a",
+			"structural",
+			"structure-",
+			"underscore",
+			"on('line'",
+			"line",
+			"link:",
+			"$apply",
+			"$digest",
+			"$apply",
+			"theme",
+			"bucket",
+			"shell",
+			"$rootScope.$on",
+			"$rootScope.on",
+			"$rootScope",
+			"DONE",
+			"Active",
+			"encountered",
+			"console.log",
+			"components",
+			"findModel",
+			".source ",
+			"embed-field",
+			"anchorNode",
+			"insertNode",
+			"ActiveDocument",
+			"follow",
+			"embed-field",
+			"shelfRepository",
+			"embed(",
+			"embed-field",
+			"embed(",
+			"embed-field",
+			"$timeout",
+			"html",
+			"toggle-editor-expand",
+			"key",
+			"rasterize",
+			"orphan.screenshot",
+			"$('",
+			"listenEditor",
+			"escape-pressed",
+			"angular",
+			"refresh",
+			".code",
+			"'change'",
+			"console.log",
+			"relative",
 			"console.log",
 			"change",
 			"ui-view",
@@ -490,67 +589,7 @@
 			"its  ",
 			"it ",
 			"DOWN",
-			"its",
-			"group_status",
-			"fake_ap	",
-			"GroupStatus",
-			"mongodb_statuses",
-			":flourish",
-			"subject",
-			"fake_nodes",
-			"knifeDash.*.gem",
-			"Version",
-			"10.0",
-			"knifeDash.*.gem",
-			"knifeDash*.gem",
-			",",
-			"'name' => 'fake-primary', 'status' => 'OK'",
-			"'status' => 'OK'",
-			" '",
-			"not_replica_set",
-			"node_name",
-			"primary_exists",
-			" if db.command({:replSetGetStatus => 1})['ok'] == 1",
-			"any_primaries",
-			"healthy?",
-			"gem_tasks",
-			"check_app_with_http",
-			"node_status",
-			"require",
-			"apps_on",
-			"fake",
-			"fake_",
-			"group_status",
-			"node_finder",
-			"all_nodes",
-			"group_status",
-			"[:",
-			"          :",
-			"check_apps",
-			"node",
-			"node_status",
-			"node",
-			"group_search_attribute",
-			"nodes_in_group",
-			"check_mongodb",
-			"nodes_in_group",
-			":status",
-			"check_apps",
-			"check_app",
-			"apps_on",
-			"apps_on ",
-			"check_apps",
-			"replicaset",
-			":cluster_name",
-			"replicaset",
-			"replica",
-			"--repl",
-			"--replSet",
-			"colinf",
-			"quote()",
-			"quote",
-			"validateSections",
-			"(),\n"
+			"its"
 		],
 		"highlight": true,
 		"in_selection": false,
@@ -576,137 +615,141 @@
 	"groups":
 	[
 		{
-			"selected": 16,
+			"selected": 19,
 			"sheets":
 			[
 				{
 					"buffer": 0,
-					"file": "index.html",
+					"file": "presentation/index.html",
 					"settings":
 					{
-						"buffer_size": 11189,
+						"buffer_size": 3417,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								9453,
-								9453
+								1542,
+								1542
 							]
 						],
 						"settings":
 						{
 							"syntax": "Packages/HTML/HTML.tmLanguage",
-							"tab_size": 2,
-							"translate_tabs_to_spaces": true
+							"translate_tabs_to_spaces": false
 						},
 						"translation.x": 0.0,
-						"translation.y": 2836.0,
+						"translation.y": 0.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 1,
-					"file": "controllers/editor.js",
+					"file": "index.html",
 					"settings":
 					{
-						"buffer_size": 6049,
+						"buffer_size": 14209,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								1687,
-								1687
+								1532,
+								1532
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
+							"syntax": "Packages/HTML/HTML.tmLanguage",
 							"tab_size": 2,
 							"translate_tabs_to_spaces": true
 						},
 						"translation.x": 0.0,
-						"translation.y": 475.0,
+						"translation.y": 293.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 2,
-					"file": "models/code.js",
+					"file": "views/code.html",
 					"settings":
 					{
-						"buffer_size": 302,
+						"buffer_size": 2012,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								262,
-								262
+								1760,
+								1760
 							]
 						],
 						"settings":
 						{
-							"auto_name": "angular.module('system').factory('CodeModel', [fun",
-							"syntax": "Packages/JavaScript/JavaScript.tmLanguage"
+							"syntax": "Packages/HTML/HTML.tmLanguage",
+							"tab_size": 2,
+							"translate_tabs_to_spaces": true
 						},
 						"translation.x": 0.0,
-						"translation.y": 0.0,
+						"translation.y": 216.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 3,
-					"file": "views/code.html",
+					"file": "shellbucket.js",
 					"settings":
 					{
-						"buffer_size": 230,
+						"buffer_size": 2045,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								115,
-								115
+								1637,
+								1637
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/HTML/HTML.tmLanguage"
+							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
+							"tab_size": 2,
+							"translate_tabs_to_spaces": true
 						},
 						"translation.x": 0.0,
-						"translation.y": 0.0,
+						"translation.y": 468.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 4,
-					"file": "models/list.js",
+					"file": "directives/angular-content.js",
 					"settings":
 					{
-						"buffer_size": 208,
+						"buffer_size": 849,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								60,
-								0
+								589,
+								589
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/JavaScript/JavaScript.tmLanguage"
+							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
+							"tab_size": 2,
+							"translate_tabs_to_spaces": true
 						},
 						"translation.x": 0.0,
 						"translation.y": 0.0,
@@ -716,23 +759,23 @@
 				},
 				{
 					"buffer": 5,
-					"file": "views/list.html",
+					"file": "directives/keypress.js",
 					"settings":
 					{
-						"buffer_size": 3062,
+						"buffer_size": 3352,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								468,
-								479
+								463,
+								463
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/HTML/HTML.tmLanguage",
+							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
 							"tab_size": 2,
 							"translate_tabs_to_spaces": true
 						},
@@ -744,18 +787,18 @@
 				},
 				{
 					"buffer": 6,
-					"file": "controllers/autocomplete.js",
+					"file": "controllers/spaces.js",
 					"settings":
 					{
-						"buffer_size": 1721,
+						"buffer_size": 472,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								1306,
-								1306
+								156,
+								156
 							]
 						],
 						"settings":
@@ -765,25 +808,25 @@
 							"translate_tabs_to_spaces": true
 						},
 						"translation.x": 0.0,
-						"translation.y": 405.0,
+						"translation.y": 0.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 7,
-					"file": "directives/context.js",
+					"file": "app.js",
 					"settings":
 					{
-						"buffer_size": 2196,
+						"buffer_size": 2032,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								436,
-								436
+								81,
+								81
 							]
 						],
 						"settings":
@@ -800,18 +843,18 @@
 				},
 				{
 					"buffer": 8,
-					"file": "app.js",
+					"file": "controllers/autocomplete.js",
 					"settings":
 					{
-						"buffer_size": 1723,
+						"buffer_size": 1869,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								1464,
-								1419
+								0,
+								0
 							]
 						],
 						"settings":
@@ -821,60 +864,59 @@
 							"translate_tabs_to_spaces": true
 						},
 						"translation.x": 0.0,
-						"translation.y": 517.0,
+						"translation.y": 0.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 9,
-					"file": "styles/main.css",
+					"file": "controllers/editor.js",
 					"settings":
 					{
-						"buffer_size": 1929,
+						"buffer_size": 7723,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								240,
-								240
+								6579,
+								6579
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/CSS/CSS.tmLanguage",
+							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
 							"tab_size": 2,
 							"translate_tabs_to_spaces": true
 						},
 						"translation.x": 0.0,
-						"translation.y": 0.0,
+						"translation.y": 3610.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 10,
-					"file": "controllers/context-controller.js",
+					"file": "controllers/hierarchy_swap.json",
 					"settings":
 					{
-						"buffer_size": 819,
+						"buffer_size": 1487,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								524,
-								524
+								0,
+								1487
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
-							"tab_size": 2,
-							"translate_tabs_to_spaces": true
+							"auto_name": "[ {",
+							"syntax": "Packages/JavaScript/JSON.tmLanguage"
 						},
 						"translation.x": 0.0,
 						"translation.y": 0.0,
@@ -884,25 +926,23 @@
 				},
 				{
 					"buffer": 11,
-					"file": "views/editor.html",
+					"file": "views/data.html",
 					"settings":
 					{
-						"buffer_size": 929,
+						"buffer_size": 292,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								802,
-								802
+								247,
+								247
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/HTML/HTML.tmLanguage",
-							"tab_size": 2,
-							"translate_tabs_to_spaces": true
+							"syntax": "Packages/HTML/HTML.tmLanguage"
 						},
 						"translation.x": 0.0,
 						"translation.y": 0.0,
@@ -912,23 +952,23 @@
 				},
 				{
 					"buffer": 12,
-					"file": "views/connect.html",
+					"file": "bucket.js",
 					"settings":
 					{
-						"buffer_size": 870,
+						"buffer_size": 1083,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								853,
-								853
+								194,
+								194
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/HTML/HTML.tmLanguage",
+							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
 							"tab_size": 2,
 							"translate_tabs_to_spaces": true
 						},
@@ -940,25 +980,23 @@
 				},
 				{
 					"buffer": 13,
-					"file": "views/connect-picker.html",
+					"file": "models/bucket.js",
 					"settings":
 					{
-						"buffer_size": 826,
+						"buffer_size": 179,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								37,
-								37
+								136,
+								128
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/HTML/HTML.tmLanguage",
-							"tab_size": 2,
-							"translate_tabs_to_spaces": true
+							"syntax": "Packages/JavaScript/JavaScript.tmLanguage"
 						},
 						"translation.x": 0.0,
 						"translation.y": 0.0,
@@ -968,51 +1006,49 @@
 				},
 				{
 					"buffer": 14,
-					"file": "views/home.html",
+					"file": "example.json",
 					"settings":
 					{
-						"buffer_size": 194,
+						"buffer_size": 12173,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								129,
-								173
+								1154,
+								1154
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/HTML/HTML.tmLanguage"
+							"syntax": "Packages/JavaScript/JSON.tmLanguage"
 						},
 						"translation.x": 0.0,
-						"translation.y": 0.0,
+						"translation.y": 100.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 15,
-					"file": "controllers/connect.js",
+					"file": "views/demo.html",
 					"settings":
 					{
-						"buffer_size": 895,
+						"buffer_size": 761,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								584,
-								584
+								482,
+								482
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
-							"tab_size": 2,
-							"translate_tabs_to_spaces": true
+							"syntax": "Packages/HTML/HTML.tmLanguage"
 						},
 						"translation.x": 0.0,
 						"translation.y": 0.0,
@@ -1022,1017 +1058,112 @@
 				},
 				{
 					"buffer": 16,
+					"file": "views/jsonlist.html",
 					"settings":
 					{
-						"buffer_size": 49247,
+						"buffer_size": 495,
 						"regions":
 						{
-							"match":
-							{
-								"flags": 112,
-								"regions":
-								[
-									[
-										271,
-										282
-									],
-									[
-										521,
-										532
-									],
-									[
-										733,
-										744
-									],
-									[
-										1113,
-										1124
-									],
-									[
-										1416,
-										1427
-									],
-									[
-										1767,
-										1778
-									],
-									[
-										1999,
-										2010
-									],
-									[
-										2348,
-										2359
-									],
-									[
-										2713,
-										2724
-									],
-									[
-										2772,
-										2783
-									],
-									[
-										2823,
-										2834
-									],
-									[
-										2874,
-										2885
-									],
-									[
-										3082,
-										3093
-									],
-									[
-										3391,
-										3402
-									],
-									[
-										3738,
-										3749
-									],
-									[
-										3997,
-										4008
-									],
-									[
-										4246,
-										4257
-									],
-									[
-										4403,
-										4414
-									],
-									[
-										4659,
-										4670
-									],
-									[
-										4755,
-										4766
-									],
-									[
-										4855,
-										4866
-									],
-									[
-										4955,
-										4966
-									],
-									[
-										5054,
-										5065
-									],
-									[
-										5155,
-										5166
-									],
-									[
-										5319,
-										5330
-									],
-									[
-										5455,
-										5466
-									],
-									[
-										5602,
-										5613
-									],
-									[
-										5788,
-										5799
-									],
-									[
-										6052,
-										6063
-									],
-									[
-										6231,
-										6242
-									],
-									[
-										6362,
-										6373
-									],
-									[
-										6620,
-										6631
-									],
-									[
-										6775,
-										6786
-									],
-									[
-										6959,
-										6970
-									],
-									[
-										7140,
-										7151
-									],
-									[
-										7434,
-										7445
-									],
-									[
-										7542,
-										7553
-									],
-									[
-										7664,
-										7675
-									],
-									[
-										7956,
-										7967
-									],
-									[
-										8235,
-										8246
-									],
-									[
-										8497,
-										8508
-									],
-									[
-										8577,
-										8588
-									],
-									[
-										8815,
-										8826
-									],
-									[
-										9045,
-										9056
-									],
-									[
-										9246,
-										9257
-									],
-									[
-										9389,
-										9400
-									],
-									[
-										9662,
-										9673
-									],
-									[
-										9841,
-										9852
-									],
-									[
-										9890,
-										9901
-									],
-									[
-										10113,
-										10124
-									],
-									[
-										10370,
-										10381
-									],
-									[
-										10734,
-										10745
-									],
-									[
-										10966,
-										10977
-									],
-									[
-										11269,
-										11280
-									],
-									[
-										11343,
-										11354
-									],
-									[
-										11567,
-										11578
-									],
-									[
-										11778,
-										11789
-									],
-									[
-										11992,
-										12003
-									],
-									[
-										12282,
-										12293
-									],
-									[
-										12406,
-										12417
-									],
-									[
-										12756,
-										12767
-									],
-									[
-										13006,
-										13017
-									],
-									[
-										13218,
-										13229
-									],
-									[
-										13598,
-										13609
-									],
-									[
-										13901,
-										13912
-									],
-									[
-										14252,
-										14263
-									],
-									[
-										14484,
-										14495
-									],
-									[
-										14833,
-										14844
-									],
-									[
-										15198,
-										15209
-									],
-									[
-										15257,
-										15268
-									],
-									[
-										15308,
-										15319
-									],
-									[
-										15359,
-										15370
-									],
-									[
-										15567,
-										15578
-									],
-									[
-										15876,
-										15887
-									],
-									[
-										16223,
-										16234
-									],
-									[
-										16482,
-										16493
-									],
-									[
-										16731,
-										16742
-									],
-									[
-										16888,
-										16899
-									],
-									[
-										17144,
-										17155
-									],
-									[
-										17240,
-										17251
-									],
-									[
-										17340,
-										17351
-									],
-									[
-										17440,
-										17451
-									],
-									[
-										17539,
-										17550
-									],
-									[
-										17640,
-										17651
-									],
-									[
-										17804,
-										17815
-									],
-									[
-										17940,
-										17951
-									],
-									[
-										18087,
-										18098
-									],
-									[
-										18273,
-										18284
-									],
-									[
-										18537,
-										18548
-									],
-									[
-										18716,
-										18727
-									],
-									[
-										18847,
-										18858
-									],
-									[
-										19105,
-										19116
-									],
-									[
-										19260,
-										19271
-									],
-									[
-										19444,
-										19455
-									],
-									[
-										19625,
-										19636
-									],
-									[
-										19919,
-										19930
-									],
-									[
-										20027,
-										20038
-									],
-									[
-										20149,
-										20160
-									],
-									[
-										20441,
-										20452
-									],
-									[
-										20720,
-										20731
-									],
-									[
-										20982,
-										20993
-									],
-									[
-										21062,
-										21073
-									],
-									[
-										21300,
-										21311
-									],
-									[
-										21530,
-										21541
-									],
-									[
-										21731,
-										21742
-									],
-									[
-										21874,
-										21885
-									],
-									[
-										22147,
-										22158
-									],
-									[
-										22326,
-										22337
-									],
-									[
-										22375,
-										22386
-									],
-									[
-										22598,
-										22609
-									],
-									[
-										22855,
-										22866
-									],
-									[
-										23219,
-										23230
-									],
-									[
-										23451,
-										23462
-									],
-									[
-										23754,
-										23765
-									],
-									[
-										23828,
-										23839
-									],
-									[
-										24052,
-										24063
-									],
-									[
-										24263,
-										24274
-									],
-									[
-										24477,
-										24488
-									],
-									[
-										24767,
-										24778
-									],
-									[
-										24891,
-										24902
-									],
-									[
-										25241,
-										25252
-									],
-									[
-										25491,
-										25502
-									],
-									[
-										25703,
-										25714
-									],
-									[
-										26083,
-										26094
-									],
-									[
-										26386,
-										26397
-									],
-									[
-										26737,
-										26748
-									],
-									[
-										26969,
-										26980
-									],
-									[
-										27318,
-										27329
-									],
-									[
-										27683,
-										27694
-									],
-									[
-										27742,
-										27753
-									],
-									[
-										27793,
-										27804
-									],
-									[
-										27844,
-										27855
-									],
-									[
-										28052,
-										28063
-									],
-									[
-										28361,
-										28372
-									],
-									[
-										28710,
-										28721
-									],
-									[
-										28959,
-										28970
-									],
-									[
-										29116,
-										29127
-									],
-									[
-										29372,
-										29383
-									],
-									[
-										29468,
-										29479
-									],
-									[
-										29568,
-										29579
-									],
-									[
-										29668,
-										29679
-									],
-									[
-										29767,
-										29778
-									],
-									[
-										29868,
-										29879
-									],
-									[
-										30032,
-										30043
-									],
-									[
-										30168,
-										30179
-									],
-									[
-										30315,
-										30326
-									],
-									[
-										30501,
-										30512
-									],
-									[
-										30765,
-										30776
-									],
-									[
-										30944,
-										30955
-									],
-									[
-										31075,
-										31086
-									],
-									[
-										31333,
-										31344
-									],
-									[
-										31488,
-										31499
-									],
-									[
-										31672,
-										31683
-									],
-									[
-										31853,
-										31864
-									],
-									[
-										32147,
-										32158
-									],
-									[
-										32255,
-										32266
-									],
-									[
-										32377,
-										32388
-									],
-									[
-										32669,
-										32680
-									],
-									[
-										32948,
-										32959
-									],
-									[
-										33210,
-										33221
-									],
-									[
-										33290,
-										33301
-									],
-									[
-										33528,
-										33539
-									],
-									[
-										33758,
-										33769
-									],
-									[
-										33959,
-										33970
-									],
-									[
-										34102,
-										34113
-									],
-									[
-										34375,
-										34386
-									],
-									[
-										34554,
-										34565
-									],
-									[
-										34603,
-										34614
-									],
-									[
-										34826,
-										34837
-									],
-									[
-										35083,
-										35094
-									],
-									[
-										35447,
-										35458
-									],
-									[
-										35679,
-										35690
-									],
-									[
-										35982,
-										35993
-									],
-									[
-										36056,
-										36067
-									],
-									[
-										36280,
-										36291
-									],
-									[
-										36491,
-										36502
-									],
-									[
-										36705,
-										36716
-									],
-									[
-										36995,
-										37006
-									],
-									[
-										37119,
-										37130
-									],
-									[
-										37469,
-										37480
-									],
-									[
-										37719,
-										37730
-									],
-									[
-										37931,
-										37942
-									],
-									[
-										38311,
-										38322
-									],
-									[
-										38614,
-										38625
-									],
-									[
-										38965,
-										38976
-									],
-									[
-										39197,
-										39208
-									],
-									[
-										39546,
-										39557
-									],
-									[
-										39911,
-										39922
-									],
-									[
-										39970,
-										39981
-									],
-									[
-										40021,
-										40032
-									],
-									[
-										40072,
-										40083
-									],
-									[
-										40280,
-										40291
-									],
-									[
-										40589,
-										40600
-									],
-									[
-										40938,
-										40949
-									],
-									[
-										41187,
-										41198
-									],
-									[
-										41344,
-										41355
-									],
-									[
-										41600,
-										41611
-									],
-									[
-										41696,
-										41707
-									],
-									[
-										41796,
-										41807
-									],
-									[
-										41896,
-										41907
-									],
-									[
-										41995,
-										42006
-									],
-									[
-										42096,
-										42107
-									],
-									[
-										42219,
-										42230
-									],
-									[
-										42366,
-										42377
-									],
-									[
-										42552,
-										42563
-									],
-									[
-										42816,
-										42827
-									],
-									[
-										42995,
-										43006
-									],
-									[
-										43126,
-										43137
-									],
-									[
-										43384,
-										43395
-									],
-									[
-										43539,
-										43550
-									],
-									[
-										43723,
-										43734
-									],
-									[
-										43904,
-										43915
-									],
-									[
-										44198,
-										44209
-									],
-									[
-										44306,
-										44317
-									],
-									[
-										44428,
-										44439
-									],
-									[
-										44720,
-										44731
-									],
-									[
-										44999,
-										45010
-									],
-									[
-										45261,
-										45272
-									],
-									[
-										45341,
-										45352
-									],
-									[
-										45579,
-										45590
-									],
-									[
-										45809,
-										45820
-									],
-									[
-										46010,
-										46021
-									],
-									[
-										46153,
-										46164
-									],
-									[
-										46426,
-										46437
-									],
-									[
-										46605,
-										46616
-									],
-									[
-										46654,
-										46665
-									],
-									[
-										46877,
-										46888
-									],
-									[
-										47134,
-										47145
-									],
-									[
-										47498,
-										47509
-									],
-									[
-										47730,
-										47741
-									],
-									[
-										48033,
-										48044
-									],
-									[
-										48107,
-										48118
-									],
-									[
-										48331,
-										48342
-									],
-									[
-										48542,
-										48553
-									],
-									[
-										48756,
-										48767
-									],
-									[
-										49046,
-										49057
-									],
-									[
-										49170,
-										49181
-									]
-								],
-								"scope": ""
-							}
 						},
 						"selection":
 						[
 							[
-								30288,
-								30288
+								162,
+								162
 							]
 						],
 						"settings":
 						{
-							"detect_indentation": false,
-							"output_tag": 4,
-							"result_base_dir": "",
-							"result_file_regex": "^([A-Za-z\\\\/<].*):$",
-							"result_line_regex": "^ +([0-9]+):",
-							"scroll_past_end": true,
-							"syntax": "Packages/Default/Find Results.hidden-tmLanguage",
-							"translate_tabs_to_spaces": false
+							"syntax": "Packages/HTML/HTML.tmLanguage"
 						},
 						"translation.x": 0.0,
-						"translation.y": 13101.0,
+						"translation.y": 0.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
 				},
 				{
 					"buffer": 17,
-					"file": "livingdocuments.sublime-project",
+					"file": "styles/tree.css",
 					"settings":
 					{
-						"buffer_size": 131,
+						"buffer_size": 121,
 						"regions":
 						{
 						},
 						"selection":
 						[
 							[
-								131,
-								131
+								119,
+								119
 							]
 						],
 						"settings":
 						{
-							"syntax": "Packages/JavaScript/JSON.tmLanguage"
+							"auto_name": ".tree li {",
+							"syntax": "Packages/CSS/CSS.tmLanguage"
+						},
+						"translation.x": 0.0,
+						"translation.y": 0.0,
+						"zoom_level": 1.0
+					},
+					"type": "text"
+				},
+				{
+					"buffer": 18,
+					"file": "directives/context.js",
+					"settings":
+					{
+						"buffer_size": 2279,
+						"regions":
+						{
+						},
+						"selection":
+						[
+							[
+								313,
+								313
+							]
+						],
+						"settings":
+						{
+							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
+							"tab_size": 2,
+							"translate_tabs_to_spaces": true
 						},
 						"translation.x": 0.0,
 						"translation.y": 0.0,
 						"zoom_level": 1.0
 					},
 					"type": "text"
+				},
+				{
+					"buffer": 19,
+					"file": "controllers/context-controller.js",
+					"settings":
+					{
+						"buffer_size": 12793,
+						"regions":
+						{
+						},
+						"selection":
+						[
+							[
+								4668,
+								4668
+							]
+						],
+						"settings":
+						{
+							"syntax": "Packages/JavaScript/JavaScript.tmLanguage",
+							"tab_size": 2,
+							"translate_tabs_to_spaces": true
+						},
+						"translation.x": 0.0,
+						"translation.y": 2596.0,
+						"zoom_level": 1.0
+					},
+					"type": "text"
 				}
 			]
 		}
@@ -2083,516 +1214,516 @@
 		"selected_items":
 		[
 			[
-				"liv",
-				"livingdocuments.sublime-project"
+				"cont",
+				"controllers/context-controller.js"
 			],
 			[
-				"connect",
-				"controllers/connect.js"
+				"exa",
+				"example.json"
+			],
+			[
+				"dem",
+				"views/demo.html"
 			],
 			[
 				"",
-				"app.js"
+				"controllers/context-controller.js"
 			],
 			[
-				"app",
-				"app.js"
+				"de",
+				"views/demo.html"
 			],
 			[
-				"connect-",
-				"views/connect-picker.html"
+				"context",
+				"controllers/context-controller.js"
 			],
 			[
-				"connect.js",
-				"controllers/connect.js"
+				"demo",
+				"views/demo.html"
 			],
 			[
-				"picker",
-				"views/connect-picker.html"
+				"exam",
+				"example.json"
 			],
 			[
-				"home",
-				"views/home.html"
+				"code",
+				"views/code.html"
 			],
 			[
-				"app.js",
-				"app.js"
+				"stru",
+				"views/structural-tree-view.html"
 			],
 			[
-				"editor",
-				"views/editor.html"
+				"str",
+				"views/structural-tree-view.html"
 			],
 			[
-				"conte",
-				"controllers/context-controller.js"
+				"json",
+				"views/jsonlist.html"
 			],
 			[
-				"context",
-				"controllers/context-controller.js"
+				"ind",
+				"index.html"
 			],
 			[
-				"code",
-				"views/code.html"
+				"demo.",
+				"views/demo.html"
 			],
 			[
-				"per",
-				"components/codemirror/mode/perl/perl.js"
+				"examp",
+				"example.json"
 			],
 			[
-				"main",
-				"styles/main.css"
+				"bucket.js",
+				"bucket.js"
 			],
 			[
-				"list",
-				"views/list.html"
+				"bucket",
+				"models/bucket.js"
 			],
 			[
-				"index",
-				"index.html"
-			],
-			[
-				"auto",
-				"controllers/autocomplete.js"
+				"data",
+				"views/data.html"
 			],
 			[
-				"list.h",
-				"views/list.html"
+				"ucket",
+				"bucket.js"
 			],
 			[
-				"edi",
-				"controllers/editor.js"
+				"data.js",
+				"controllers/dataobject.js"
 			],
 			[
-				"docu",
-				"repositories/document.js"
+				"data.ht",
+				"views/data.html"
 			],
 			[
-				"connect.h",
-				"views/connect.html"
+				"editor",
+				"controllers/editor.js"
 			],
 			[
-				"conne",
-				"controllers/connect.js"
+				"auto",
+				"controllers/autocomplete.js"
 			],
 			[
-				"context.js",
-				"directives/context.js"
+				"app",
+				"app.js"
 			],
 			[
-				"conn",
-				"controllers/connect.js"
+				"presentation/",
+				"presentation/index.html"
 			],
 			[
-				"embed",
-				"controllers/embed.js"
+				"list",
+				"models/list.js"
 			],
 			[
-				"inde",
-				"index.html"
+				"list.",
+				"views/list.html"
 			],
 			[
-				"contxt",
-				"controllers/context-controller.js"
+				"context.js",
+				"directives/context.js"
 			],
 			[
-				"list.js",
-				"models/list.js"
+				"dit",
+				"controllers/editor.js"
 			],
 			[
-				"ma",
-				"styles/main.css"
+				"edit",
+				"controllers/editor.js"
 			],
 			[
-				"mai",
-				"styles/main.css"
+				"bucke",
+				"services/buckets.js"
 			],
 			[
-				"tmai",
-				"styles/main.css"
+				"inde",
+				"index.html"
 			],
 			[
-				"cont",
-				"directives/context.js"
+				"feed.cs",
+				"styles/feed.css"
 			],
 			[
-				"main.css",
+				"main",
 				"styles/main.css"
 			],
 			[
-				"data",
-				"controllers/dataobject.js"
+				"aut",
+				"controllers/autocomplete.js"
 			],
 			[
-				"dat",
-				"controllers/dataobject.js"
+				"buckets",
+				"services/buckets.js"
 			],
 			[
-				"da",
-				"controllers/dataobject.js"
+				"buc",
+				"bucket.js"
 			],
 			[
-				"li",
-				"views/list.html"
+				"side",
+				"views/sidebar.html"
 			],
 			[
-				"editor.js",
-				"controllers/editor.js"
-			],
-			[
-				"content",
-				"directives/contenteditable.js"
+				"angular",
+				"directives/angular-content.js"
 			],
 			[
-				"keyp",
-				"directives/keypress.js"
+				"docu",
+				"repositories/document.js"
 			],
 			[
-				"list.",
-				"views/list.html"
+				"sidebar",
+				"views/sidebar.html"
 			],
 			[
-				"feed.js",
-				"repositories/feed.js"
+				"app.js",
+				"app.js"
 			],
 			[
-				"when-",
-				"directives/when-blur.js"
+				"index",
+				"index.html"
 			],
 			[
-				"spaces",
-				"controllers/spaces.js"
+				"feed.css",
+				"styles/feed.css"
 			],
 			[
-				"when",
-				"directives/when-blur.js"
+				"mai",
+				"styles/main.css"
 			],
 			[
-				"spaces.js",
-				"controllers/spaces.js"
+				"anal",
+				"utils/analysis.js"
 			],
 			[
-				"angu",
-				"directives/angular-content.js"
+				"app.",
+				"app.js"
 			],
 			[
-				"angular",
-				"directives/angular-content.js"
+				"home.js",
+				"controllers/home.js"
 			],
 			[
-				"space",
-				"views/spaces.html"
+				"shelf",
+				"controllers/shelf.js"
 			],
 			[
-				"sp",
-				"styles/spaces.css"
+				"context-",
+				"controllers/context-controller.js"
 			],
 			[
-				"angular-",
-				"directives/angular-content.js"
+				"edito",
+				"controllers/editor.js"
 			],
 			[
 				"feed",
 				"repositories/feed.js"
 			],
 			[
-				"spaces.css",
-				"styles/spaces.css"
+				"spaces",
+				"controllers/spaces.js"
 			],
 			[
-				"run",
-				"directives/angular-content.js"
+				"embed",
+				"controllers/embed.js"
 			],
 			[
-				"run-",
-				"directives/run-angular.js"
+				"shel",
+				"views/shelf.html"
 			],
 			[
-				"key",
-				"directives/keypress.js"
+				"scre",
+				"directives/screenshot.js"
 			],
 			[
-				"feed.",
-				"repositories/feed.js"
+				"she",
+				"repositories/shelf.js"
 			],
 			[
-				"spaces.",
-				"styles/spaces.css"
+				"scree",
+				"directives/screenshot.js"
 			],
 			[
-				"viewer",
-				"controllers/viewer.js"
+				"shelf.html",
+				"views/shelf.html"
 			],
 			[
-				"view",
-				"views/demo.html"
+				"structural-tree-view",
+				"views/structural-tree-view.html"
 			],
 			[
-				"spaces.html",
-				"views/spaces.html"
+				"listht",
+				"views/list.html"
 			],
 			[
-				"editor.html",
+				"editor.ht",
 				"views/editor.html"
 			],
 			[
-				"editab",
-				"directives/contenteditable.js"
+				"home",
+				"views/home.html"
 			],
 			[
-				"edito",
-				"controllers/editor.js"
+				"focu",
+				"directives/focus-when.js"
 			],
 			[
-				"autocom",
+				"autoco",
 				"views/autocomplete.html"
 			],
 			[
-				"autoco",
-				"views/autocomplete.html"
+				"autoc",
+				"controllers/autocomplete.js"
 			],
 			[
-				"exampl",
-				"example.json"
+				"ma",
+				"styles/main.css"
 			],
 			[
-				"edit",
-				"controllers/editor.js"
+				"shelf.ht",
+				"views/shelf.html"
 			],
 			[
-				"emed",
-				"views/embed.html"
+				"conte",
+				"directives/context.js"
 			],
 			[
-				"embe",
-				"views/embed.html"
+				"contr",
+				"controllers/context-controller.js"
 			],
 			[
-				"emb",
-				"views/embed.html"
+				"tree",
+				"services/dependency-tree-generator.js"
 			],
 			[
-				"embed.",
-				"views/embed.html"
+				"dep",
+				"services/dependency-tree-generator.js"
 			],
 			[
-				"embed.css",
-				"styles/embedded.css"
+				"spaces.css",
+				"styles/spaces.css"
 			],
 			[
-				"autoc",
-				"controllers/autocomplete.js"
+				"code.",
+				"views/code.html"
 			],
 			[
-				"embed.js",
-				"controllers/embed.js"
+				"key",
+				"directives/keypress.js"
 			],
 			[
-				"packer",
-				"directives/packery.js"
+				"edi",
+				"controllers/editor.js"
 			],
 			[
-				"inter",
-				"directives/interested-in-focus.js"
+				"edto",
+				"controllers/editor.js"
 			],
 			[
-				"autocomplete",
-				"controllers/autocomplete.js"
+				"list.ht",
+				"views/list.html"
 			],
 			[
-				"focus",
-				"directives/focus-when.js"
+				"ng-mo",
+				"directives/ng-model-onblur.js"
 			],
 			[
-				"editor.",
-				"views/editor.html"
+				"index.",
+				"index.html"
 			],
 			[
-				"list.html",
-				"views/list.html"
+				"ng-",
+				"directives/ng-model-onblur.js"
 			],
 			[
-				"columongo",
-				"chef-repo/cookbooks/columbus_mongodb/files/default/mongo_sizing.rb"
+				"st",
+				"views/structural-tree-view.html"
 			],
 			[
-				"collectinator/rec",
-				"chef-repo/cookbooks/collectinator/recipes/default.rb"
+				"codem",
+				"views/code.html"
 			],
 			[
-				"db-co",
-				"chef-repo/roles/db-collectinator.rb"
+				"list.js",
+				"models/list.js"
 			],
 			[
-				"collectinator/recip",
-				"chef-repo/cookbooks/collectinator/recipes/default.rb"
+				"mode",
+				"models/code.js"
 			],
 			[
-				"columbus_hosts",
-				"chef-repo/cookbooks/columbus_hosts/recipes/default.rb"
+				"code.ht",
+				"views/code.html"
 			],
 			[
-				"chef-repo/cookbooks/collectinator/attributes/default.rb",
-				"chef-repo/cookbooks/collectinator/attributes/default.rb"
+				"code.js",
+				"models/code.js"
 			],
 			[
-				"collectatt",
-				"chef-repo/cookbooks/collectinator/attributes/default.rb"
+				"code.html",
+				"views/code.html"
 			],
 			[
-				"krypton/attributes",
-				"chef-repo/cookbooks/krypton/attributes/default.rb"
+				"iframe",
+				"directives/iframe.js"
 			],
 			[
-				"columbus_hosts/recipes",
-				"chef-repo/cookbooks/columbus_hosts/recipes/default.rb"
+				"editor.js",
+				"controllers/editor.js"
 			],
 			[
-				"columbus_hosts/spec/default_spec.rb",
-				"chef-repo/cookbooks/columbus_hosts/spec/default_spec.rb"
+				"connect.js",
+				"controllers/connect.js"
 			],
 			[
-				"roles/db",
-				"chef-repo/roles/db-collectinator.rb"
+				"connect",
+				"views/connect.html"
 			],
 			[
-				"collectinator/re",
-				"chef-repo/cookbooks/collectinator/recipes/default.rb"
+				"liv",
+				"livingdocuments.sublime-project"
 			],
 			[
-				"attribut",
-				"chef-repo/cookbooks/krypton/attributes/default.rb"
+				"connect-",
+				"views/connect-picker.html"
 			],
 			[
-				"collectinator/reci",
-				"chef-repo/cookbooks/collectinator/recipes/default.rb"
+				"picker",
+				"views/connect-picker.html"
 			],
 			[
-				"deco.rb",
-				"chef-repo/roles/deco.rb"
+				"per",
+				"components/codemirror/mode/perl/perl.js"
 			],
 			[
-				"db-col",
-				"chef-repo/roles/db-collectinator.rb"
+				"list.h",
+				"views/list.html"
 			],
 			[
-				"node",
-				"knifeDash/lib/knife_dash/node_finder.rb"
+				"connect.h",
+				"views/connect.html"
 			],
 			[
-				"knifedashgem",
-				"chef-repo/cookbooks/columbus_monitoring/files/default/knifeDash-0.0.11.gem"
+				"conne",
+				"controllers/connect.js"
 			],
 			[
-				"gem",
-				"Gemfile"
+				"conn",
+				"controllers/connect.js"
 			],
 			[
-				"c",
-				"criticize.sh"
+				"contxt",
+				"controllers/context-controller.js"
 			],
 			[
-				"group",
-				"knifeDash/lib/knife_dash/group_status.rb"
+				"tmai",
+				"styles/main.css"
 			],
 			[
-				"knife-d",
-				"knifeDash/config/knife-dash.yml"
+				"main.css",
+				"styles/main.css"
 			],
 			[
-				"knife",
-				"knifeDash/go.sh"
+				"dat",
+				"controllers/dataobject.js"
 			],
 			[
-				"knifedash",
-				"chef-repo/cookbooks/columbus_monitoring/recipes/knifeDash.rb"
+				"da",
+				"controllers/dataobject.js"
 			],
 			[
-				"jenkinsde",
-				"chef-repo/cookbooks/provisioner/files/default/jenkins-deploy.sh"
+				"li",
+				"views/list.html"
 			],
 			[
-				"article",
-				"test/frontend/feature/article.clj"
+				"content",
+				"directives/contenteditable.js"
 			],
 			[
-				"articlesp",
-				"test/frontend/js/spec/ArticleSpec.js"
+				"keyp",
+				"directives/keypress.js"
 			],
 			[
-				"articlessp",
-				"test/frontend/js/spec/articleFieldsSpec.js"
+				"feed.js",
+				"repositories/feed.js"
 			],
 			[
-				"articlemodel",
-				"resources/public/scripts/app/article/articleModel.js"
+				"when-",
+				"directives/when-blur.js"
 			],
 			[
-				"articlecomm",
-				"test/frontend/js/spec/articleCommons.js"
+				"when",
+				"directives/when-blur.js"
 			],
 			[
-				"fieldspec",
-				"test/frontend/js/spec/articleFieldsSpec.js"
+				"spaces.js",
+				"controllers/spaces.js"
 			],
 			[
-				"spec",
-				"test/frontend/js/SpecRunner.html"
+				"angu",
+				"directives/angular-content.js"
 			],
 			[
-				"articlevm",
-				"resources/public/scripts/app/article/articleFieldsVM.js"
+				"space",
+				"views/spaces.html"
 			],
 			[
-				"articlefi",
-				"test/frontend/js/spec/articleFieldsSpec.js"
+				"sp",
+				"styles/spaces.css"
 			],
 			[
-				"artifiel",
-				"resources/public/scripts/app/article/articleFieldsVM.js"
+				"angular-",
+				"directives/angular-content.js"
 			],
 			[
-				"page",
-				"resources/public/scripts/app/page.js"
+				"run",
+				"directives/angular-content.js"
 			],
 			[
-				"core",
-				"src/krypton/core.clj"
+				"run-",
+				"directives/run-angular.js"
 			],
 			[
-				"new",
-				"resources/templates/scripts/new-article.html"
+				"feed.",
+				"repositories/feed.js"
 			],
 			[
-				"stati",
-				"src/krypton/controller/static.clj"
+				"spaces.",
+				"styles/spaces.css"
 			],
 			[
-				"query",
-				"src/krypton/query.clj"
+				"viewer",
+				"controllers/viewer.js"
 			],
 			[
-				"util",
-				"src/krypton/utils.clj"
+				"view",
+				"views/demo.html"
 			],
 			[
-				"mongo",
-				"src/krypton/mongo.clj"
+				"spaces.html",
+				"views/spaces.html"
+			],
+			[
+				"editor.html",
+				"views/editor.html"
 			],
 			[
-				"proj",
-				"project.clj"
+				"editab",
+				"directives/contenteditable.js"
 			],
 			[
-				"pr",
-				"project.clj"
+				"autocom",
+				"views/autocomplete.html"
 			],
 			[
-				"document.",
-				"src/krypton/controller/document.clj"
+				"exampl",
+				"example.json"
 			],
 			[
-				"paging",
-				"src/krypton/paging.clj"
+				"emed",
+				"views/embed.html"
 			]
 		],
 		"width": 0.0
@@ -2608,7 +1739,7 @@
 	"show_minimap": true,
 	"show_open_files": true,
 	"show_tabs": true,
-	"side_bar_visible": true,
+	"side_bar_visible": false,
 	"side_bar_width": 226.0,
 	"status_bar_visible": true
 }
diff --git a/models/bucket.js b/models/bucket.js
index 13e33df..05d161f 100644
--- a/models/bucket.js
+++ b/models/bucket.js
@@ -2,7 +2,8 @@ angular.module('system').factory('BucketModel', [function () {
 
   function BucketModel() {
     return {
-      lines : []
+      lines : [],
+      headings: []
     }
   }
 
diff --git a/models/documentModel.js b/models/documentModel.js
new file mode 100644
index 0000000..a84eb2a
--- /dev/null
+++ b/models/documentModel.js
@@ -0,0 +1,12 @@
+angular.module('system').factory('DocumentModel', function () {
+
+  function Document() {
+    var self = this;
+    self.contents = "";
+    self.fields = [];
+    self.instances = [];
+    self._id = new Date().getTime();
+  }
+
+return Document;
+});
\ No newline at end of file
diff --git a/models/subdocument.js b/models/subdocument.js
new file mode 100644
index 0000000..19a842d
--- /dev/null
+++ b/models/subdocument.js
@@ -0,0 +1,10 @@
+angular.module('system').factory('SubdocumentModel', [function () {
+
+  function Subdocument() {
+    return {
+      ref: ""
+    };
+  }
+  return Subdocument;
+
+}])
\ No newline at end of file
diff --git a/patterns/main.jape b/patterns/main.jape
new file mode 100644
index 0000000..2cc4935
--- /dev/null
+++ b/patterns/main.jape
@@ -0,0 +1,17 @@
+/*
+*  main.jape
+*
+* Copyright (c) 1998-2004, The University of Sheffield.
+*
+*  This file is part of GATE (see http://gate.ac.uk/), and is free
+*  software, licenced under the GNU Library General Public License,
+*  Version 2, June 1991 (in the distribution as file licence.html,
+*  and also available at http://gate.ac.uk/gate/licence.html).
+*
+*  Diana Maynard, 02 Aug 2001
+*
+*  $Id: main.jape 9233 2007-11-23 13:01:52Z dgmaynard $
+*/
+
+Phases:
+phone
\ No newline at end of file
diff --git a/patterns/phone.jape b/patterns/phone.jape
new file mode 100644
index 0000000..5237562
--- /dev/null
+++ b/patterns/phone.jape
@@ -0,0 +1,17 @@
+Phase:	Phone
+Input:  Token Lookup
+Options: control = appelt
+
+// Phone
+
+Rule:phoneNumber
+Priority: 50
+(
+  ({Token.string == "+"})?
+  ({Token.kind == number, Token.length >= 6})
+):phoneNumber
+
+--> :phoneNumber.PhoneNumber= {kind = "phoneNumber", rule = "phoneNumber"}
+
+
+
diff --git a/prototypes/index.html b/prototypes/index.html
new file mode 100644
index 0000000..0fe490b
--- /dev/null
+++ b/prototypes/index.html
@@ -0,0 +1,163 @@
+<!DOCTYPE html>
+<html>
+<head>
+<meta charset=utf-8 />
+<title>Mockup</title>
+<script src="http://localhost:8000/jquery.min.js"></script>
+
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/basic.icon.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/icon.css">
+
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/button.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/divider.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/header.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/image.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/input.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/label.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/loader.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/progress.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/segment.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/elements/step.css">
+
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/collections/breadcrumb.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/collections/form.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/collections/grid.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/collections/menu.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/collections/message.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/collections/table.css">
+
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/views/comment.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/views/list.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/views/feed.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/views/item.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/views/statistic.css">
+
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/modal.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/accordion.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/dropdown.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/popup.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/reveal.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/rating.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/sidebar.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/shape.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/tab.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/checkbox.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/dimmer.css">
+  <link rel="stylesheet" type="text/css" class="ui" href="http://localhost:8000/semantic/uncompressed/modules/transition.css">
+
+  <link rel="stylesheet" type="text/css" href="http://localhost:8000/semantic/packaged/css/semantic.css">
+<!--
+  <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,900" rel="stylesheet">
+ -->
+  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Open+Sans:300italic,400,300,700' rel='stylesheet' type='text/css'>
+
+
+  <script src="http://localhost:8000/semantic/uncompressed/modules/behavior/api.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/behavior/state.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/accordion.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/checkbox.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/dimmer.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/dropdown.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/modal.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/popup.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/rating.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/sidebar.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/tab.js"></script>
+  <script src="http://localhost:8000/semantic/uncompressed/modules/transition.js"></script>
+
+  <script src="http://localhost:8000/semantic/packaged/javascript/semantic.js"></script>
+</head>
+
+<body>
+
+<div class="ui inverted main menu tiered">
+  <a class="active item">
+    <i class="home icon"></i> Home
+  </a>
+  <a class="item">
+    <i class="mail icon"></i> Messages
+  </a>
+  <a class="item">
+    <i class="user icon"></i> Friends
+  </a>
+  <a class="item right menu">
+    <div class="">
+      <i class="user icon"></i>samsquire
+    </div>
+  </a>
+
+
+  <div class="ui sub menu">
+    <a class="active item">Ideas</a>
+    <a class="item">Knowledgebase</a>
+    <a class="item">Blogs</a>
+  </div>
+
+</div>
+
+<h4>Feed</h4>
+<div class="ui piled feed segment">
+
+  <h2 class="ui header">
+    Recent Activity
+  </h2>
+
+  <div class="event">
+    <div class="label">
+      <i class="circular user icon"></i>
+    </div>
+    <div class="content">
+      <div class="date">
+        Just moments ago
+      </div>
+      <div class="summary">
+         <a>Sally Poodle</a> added you as a friend
+      </div>
+    </div>
+  </div>
+
+  <div class="event">
+    <div class="label">
+      <i class="circular pencil icon"></i>
+    </div>
+    <div class="content">
+      <div class="date">
+        3 days ago
+      </div>
+      <div class="summary">
+        You submitted a new post to the page
+      </div>
+      <div class="extra text">
+        Collecting the best science fiction movies.
+      </div>
+    </div>
+  </div>
+
+  <div class="event">
+    <div class="label">
+      <i class="circular photo icon"></i>
+    </div>
+    <div class="content">
+      <div class="date">
+        3 days ago
+      </div>
+      <div class="summary">
+        <a>Sally Poodle</a> added <a>2 new photos</a> of you
+      </div>
+      <div class="extra images">
+        <img src="/images/demo/item1.jpg">
+        <img src="/images/demo/item2.jpg">
+      </div>
+    </div>
+  </div>
+</div>
+
+<h4>Other</h4>
+
+
+  
+</body>
+</html>
+
+
+
diff --git a/repositories/document.js b/repositories/document.js
index 250f903..7ce4915 100644
--- a/repositories/document.js
+++ b/repositories/document.js
@@ -1,10 +1,3 @@
-angular.module('system').factory('ActiveDocument', [function () {
-
-  function Document() {
-    var self = this;
-    self.fields = [];
-    self.instances = [];
-  }
-
-  return new Document();
+angular.module('system').factory('ActiveDocument', ['DocumentModel', function (DocumentModel) {
+  return new DocumentModel();
 }]);
\ No newline at end of file
diff --git a/repositories/feed.js b/repositories/feed.js
index 5eb4687..0739095 100644
--- a/repositories/feed.js
+++ b/repositories/feed.js
@@ -17,6 +17,11 @@ angular.module('system').factory('feed', [function () {
 
     self.ids = {};
     self.items = [];
+    self.waiting = {};
+
+    self.waitFor = function (id, callback) {
+      self.waiting[id] = callback;
+    }
 
     self.addition = function (docs) {
       docs.forEach(function (doc) {
@@ -28,6 +33,10 @@ angular.module('system').factory('feed', [function () {
         } else {
           self.ids[doc._id] = doc;
           self.items.push(doc);
+          if (self.waiting[doc._id]) {
+            self.waiting[doc._id](doc);
+            delete self.waiting[doc._id];
+          }
         }
       });
     };
@@ -73,7 +82,7 @@ angular.module('system').factory('feed', [function () {
       db.post(item, callback);
     };
 
-    self.update = function (feedItem) {
+    self.update = function (feedItem, callback) {
       console.log('Updated', feedItem);
       var rev = feedItem._rev;
       db.remove(feedItem);
@@ -83,6 +92,7 @@ angular.module('system').factory('feed', [function () {
       db.put(feedItem, {}, function (err) {
         console.log(err);
       });
+      callback(feedItem);
     };
   }
   return new Feed();
diff --git a/repositories/shelf.js b/repositories/shelf.js
index e818d8b..fccbbae 100644
--- a/repositories/shelf.js
+++ b/repositories/shelf.js
@@ -4,6 +4,7 @@ angular.module('system').factory('shelfRepository', [function () {
     var self = this;
 
     self.items = [];
+    self.objects = [];
   }
 
   return new ShelfRepository();
diff --git a/shellbucket.js b/shellbucket.js
index a459d41..5072763 100644
--- a/shellbucket.js
+++ b/shellbucket.js
@@ -53,11 +53,12 @@ var shell = io.of('/shell').on('connection', function(socket) {
     stream.pipe(split()).on('data', function (buf) {
      db.put(outputName + '-' + lexi.pack(seq++, 'hex'), buf)
     }).on('end', function () {
+      var lines = [];
       db.createReadStream({
          start: outputName,
          end: outputName + '-\uffff' }
       ).on('data', function (line) {
-        shell.emit('line', {line: line.value});
+        lines.push(line.value);
       }).on('error', function (err) {
         console.log('Oh my!', err)
       })
@@ -66,6 +67,7 @@ var shell = io.of('/shell').on('connection', function(socket) {
       })
       .on('end', function () {
         console.log('Stream closed')
+        shell.emit('line', {lines: lines});
       });
     });
 
diff --git a/shellbucket.sh b/shellbucket.sh
index 7608b2a..146f9da 100755
--- a/shellbucket.sh
+++ b/shellbucket.sh
@@ -15,10 +15,8 @@ socket.on('connect', function () {
   process.stdin.on('end', function () {
     console.log("stdin finished");
     stream.end();
+    process.exit();
   });
   var read = process.stdin.pipe(stream);
-
-
-  console.log("callbacks in queue");
 });
 
diff --git a/styles/autocomplete.css b/styles/autocomplete.css
index 9e510b6..ddfe012 100644
--- a/styles/autocomplete.css
+++ b/styles/autocomplete.css
@@ -1,5 +1,9 @@
-.dropdown {
+.boxed {
   box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
+}
+
+.dropdown {
+  
   font-size: 10pt;
   max-width: 600px;
   max-height: 250px;
@@ -11,6 +15,11 @@
   z-index: 100;
 }
 
+.wizard {
+  width: 600px;
+  height: 400px;
+}
+
 .dropdown .dropheader {
   font-weight: bold;
 }
diff --git a/styles/feed.css b/styles/feed.css
index a41cd24..bed55d6 100644
--- a/styles/feed.css
+++ b/styles/feed.css
@@ -8,7 +8,7 @@
   font-size: 16pt;
   font-family: Tahoma;
   padding-left: 5px;
-  overflow: scroll;
+  overflow: hidden;
   margin-bottom: 0.3em;
   padding-top: 0px;
   -webkit-transition: all 0.5s ease;
diff --git a/styles/main.css b/styles/main.css
index 86f6e2c..f55cf81 100644
--- a/styles/main.css
+++ b/styles/main.css
@@ -21,7 +21,7 @@ body {
   background-color: white;
   height: 5em;
   min-width: 200vw;
-  overflow: scroll;
+  overflow: scroll-y;
   white-space: nowrap;
 }
 
@@ -147,6 +147,6 @@ body {
   box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
   font-size: 10pt;
   position: absolute;
-  overflow: scroll;
+  overflow: scroll-y;
   background-color: white;
 }
\ No newline at end of file
diff --git a/styles/spaces.css b/styles/spaces.css
index 8353869..1a6a999 100644
--- a/styles/spaces.css
+++ b/styles/spaces.css
@@ -1,10 +1,11 @@
 .context {
  
- width: 95vw;
- height: 500px;
+ width: 250px;
+ height: 300px;
 /*   height: 400px;
   overflow: scroll;
-  white-space: pre-wrap;*/
+  white-space: pre-wrap;
+  */
 }
 
 .spaces {
diff --git a/styles/tree.css b/styles/tree.css
new file mode 100644
index 0000000..b015e83
--- /dev/null
+++ b/styles/tree.css
@@ -0,0 +1,7 @@
+.tree ol {
+  border: 1px solid black;
+  border-radius: 0.3em;
+  padding: 0.2em;
+  margin: 1em;
+  list-style-type: none;
+}
\ No newline at end of file
diff --git a/text_mining.txt b/text_mining.txt
new file mode 100644
index 0000000..c56c45b
--- /dev/null
+++ b/text_mining.txt
@@ -0,0 +1,23 @@
+I want to match on the following things:
+
+250gb
+
+100GiB 50kb 50KB
+
++0778885540
+
+10 minute walk
+
+tomorrow
+yesterday
+
+GIVEN
+WHEN
+THEN
+
+username@host
+
+
+7 Tanker Hill
+UK
+
diff --git a/utils/cleaner.js b/utils/cleaner.js
new file mode 100644
index 0000000..fee553e
--- /dev/null
+++ b/utils/cleaner.js
@@ -0,0 +1,12 @@
+angular.module('system').service('cleaner', function () {
+  this.filter = function (text) {
+    var contents = $($.parseHTML(text));
+    var elements = $('<div>').append(contents);
+    var removed = elements.find(".embedded-context").remove();
+    console.log(elements.find(".ng-scope").removeClass("ng-scope"));
+    console.log();
+    console.log("Removed", elements.html());
+    console.log();
+    return elements;
+  }
+});
\ No newline at end of file
diff --git a/views/autocomplete.html b/views/autocomplete.html
index e3864c2..daf2ebc 100644
--- a/views/autocomplete.html
+++ b/views/autocomplete.html
@@ -1,12 +1,5 @@
-<div ng-show="open" directional-focus="{container: 'ol', items: 'li'}" numbered-focus="li">
-  <ol ng-class="{start: $first}" ng-repeat="optionList in options">
-    <li focus-when="$parent.$first && $first && $parent.open"
-    tabindex="{{$index + 1 + options[$parent.$index - 1].length}}"
-    ng-repeat="item in optionList" 
-    ng-click="execute(item)"
-    ng-switch="item.templateUrl">
-      <span ng-switch-when="undefined" ng-bind="item.title"></span>
-      <span ng-switch-default ng-include="item.templateUrl"></span>
-    </li>
-  </div>
+<div class="dropdown-follow boxed dropdown" ng-show="open" directional-focus="{container: 'ol', items: 'li'}" numbered-focus="li">
+  <div ng-include="'views/dropdown.html'"></div>
+  <div ng-show="!choosing" class="boxed wizard" ui-view></div>
 </div>
+
diff --git a/views/code.html b/views/code.html
index e0ad437..97f9d86 100644
--- a/views/code.html
+++ b/views/code.html
@@ -1,6 +1,12 @@
 <div tabindex="0" class="ui embedded-context code" contenteditable="false">
+
+
+
   <div class="ui grid">
-  <div class="ui fifteen wide column content">
+    <div class="ui one wide column compact">
+      <i class="fa fa-2x fa-chevron-left"></i>
+    </div>
+  <div class="ui fourteen wide column content">
 
         <textarea ng-model="activeField.source"
           ui-codemirror="codemirror(activeField.editorOptions)"
@@ -23,7 +29,7 @@
 
       <div class="idea-action item three wide column right vertically fitted">
         <div class="cont">
-          <div class="compact idea-item ui vertical transparent menu">
+          <div class="idea-item ui vertical transparent menu two wide">
             <a class="item" ng-repeat="action in activeField.actions" ng-click="follow(action, $index, $event)">
               <i class="{{action.icon}} icon"></i>
               {{action.text}}
@@ -53,4 +59,11 @@
               </div>
         </div>
     </div>
+    <div class="ui one wide column compact">
+      <i class="fa fa-2x fa-chevron-right"></i>
+</div>
+</div>
+
+
+
 </div>
\ No newline at end of file
diff --git a/views/data.html b/views/data.html
index 672ba90..0f35481 100644
--- a/views/data.html
+++ b/views/data.html
@@ -1,4 +1,8 @@
 <div class="embedded-context">
-    <div ng-repeat="line in activeField.lines | limitTo: 100" ng-bind="line"></div>
-  
+  <table>
+    <th ng-repeat="heading in activeField.headings" ng-bind="heading"></th>
+    <tr ng-repeat="line in activeField.lines">
+      <td ng-repeat="cell in activeField.headings" ng-bind="$parent.line[cell]"></td>
+    </tr>
+  </table>
 </div>
\ No newline at end of file
diff --git a/views/demo.html b/views/demo.html
index 1b74ffe..d0a44cd 100644
--- a/views/demo.html
+++ b/views/demo.html
@@ -1,7 +1,36 @@
 Stuff to track with Andy and Oli
 
+<h1>business ideas</h1>
+<a href="" rel="embedded" data-kind="list" data-id="5"></a>
+
 <h1>Our Puns</h1>
 <a href="" rel="embedded" data-kind="list" data-id="0"></a>
 
 <h1>Films</h1>
-<a href="" rel="embedded" data-kind="list" data-id="0"></a>
\ No newline at end of file
+<a href="" rel="embedded" data-kind="list" data-id="0"></a>
+
+
+<div class="ui grid">
+  
+  <div class="three wide column">
+    <h1>before</h1>
+    <a href="" rel="embedded" data-kind="jsonlist" data-id="1"></a>
+  </div>
+
+
+  <div class="three wide column">
+      <h1>after</h1>
+      <a href="" rel="embedded" data-kind="jsonlist" data-id="2"></a>
+  </div>
+
+  <div class="three wide column">
+      <h1>twice</h1>
+      <a href="" rel="embedded" data-kind="jsonlist" data-id="3"></a>
+  </div>
+
+  <div class="three wide column">
+      <h1>attempt</h1>
+      <a href="" rel="embedded" data-kind="jsonlist" data-id="4"></a>
+  </div>
+
+</div>
\ No newline at end of file
diff --git a/views/dropdown.html b/views/dropdown.html
new file mode 100644
index 0000000..aed168f
--- /dev/null
+++ b/views/dropdown.html
@@ -0,0 +1,10 @@
+<ol ng-show="choosing" ng-class="{start: $first}" ng-repeat="optionList in options">
+    <li focus-when="$parent.$first && $first && $parent.open"
+    tabindex="{{$index + 1 + options[$parent.$index - 1].length}}"
+    ng-repeat="item in optionList" 
+    ng-click="execute(item)"
+    ng-switch="item.templateUrl">
+      <span ng-switch-when="undefined" ng-bind="item.title"></span>
+      <span ng-switch-default ng-include="item.templateUrl"></span>
+    </li>
+  </ol>
\ No newline at end of file
diff --git a/views/edit-document.html b/views/edit-document.html
new file mode 100644
index 0000000..52016e6
--- /dev/null
+++ b/views/edit-document.html
@@ -0,0 +1,5 @@
+<div ui-view="@shelf"></div>
+<div class="ui segment">
+  <div ui-view="@editor"></div>
+</div>
+<div ui-view="@dropdown"></div>
\ No newline at end of file
diff --git a/views/editor.html b/views/editor.html
index d23d44c..9729cf0 100644
--- a/views/editor.html
+++ b/views/editor.html
@@ -4,11 +4,14 @@
       <div class="row">
         <div class="fifteen wide column">
           <!-- Having performance issues with 'focus-when' focus-when="active" -->
-          <div  interested-in-focus="active" tabindex="1" ng-model="body" ng-show="true" follow=".dropdown-follow" contenteditable="true" class="ui segment attached left post-body segment" ng-class="{open: open}" type="text">
-            <div>&nbsp;</div>
-            <!-- <a rel="embedded" data-kind="list" data-id="0" href="0" class="ng-scope"></a> -->
-            <div>&nbsp;</div>
-          </div>
+          <div data-document-id="{{ activeDocument._id }}"
+          interested-in-focus="active"
+          tabindex="1"
+          ng-model="activeDocument.contents" ng-show="true" follow=".dropdown-follow" contenteditable="true"
+          document-model="activeDocument"
+          angular-content="activeDocument.contents"
+          incremental="true"
+          class="ui segment attached left post-body segment" ng-class="{open: open}" type="text"></div>
           <!-- <textarea follow=".dropdown" class="post-body segment" ng-model="body">
             Test
           </textarea> -->
diff --git a/views/home.html b/views/home.html
index 07adac2..5ca3942 100644
--- a/views/home.html
+++ b/views/home.html
@@ -1,7 +1,8 @@
+<div ui-view="@shelf"></div>
 <div class="ui segment">
   <div ui-view="@editor"></div>
 </div>
-<div class="dropdown-follow dropdown" ui-view="@dropdown"></div>
-<div ui-view="@shelf"></div>
+
+<div ui-view="@dropdown"></div>
 <div class="spaces" ui-view="@spaces"></div>
 <div ui-view></div>
diff --git a/views/jsonlist.html b/views/jsonlist.html
new file mode 100644
index 0000000..c87e2cc
--- /dev/null
+++ b/views/jsonlist.html
@@ -0,0 +1,21 @@
+<script type="text/ng-template" id="parent">
+<ol ng-repeat="node in currentNode.children">
+    <li>
+    <span ng-click="swap(currentNode, parent, $parent.parent, $index, $parent.$index)">
+    {{ node.name }}
+    </span>
+
+    <div ng-init="
+    parent = currentNode;
+    currentNode = node"
+        ng-include="'parent'"></div>
+    </li>
+  </ol>
+</script>
+
+<div class="tree">
+  <div ng-init="parent = activeField.parents; currentNode = activeField.parents" ng-include="'parent'"></div>
+</div>
+
+
+
diff --git a/views/shelf.html b/views/shelf.html
index f432063..73b428e 100644
--- a/views/shelf.html
+++ b/views/shelf.html
@@ -1,6 +1,27 @@
 <div class="orphan-shelf">
   <div class="shelf">
     
+  <span ng-repeat="shelfItem in objects" class="shelfItem">
+    {{ shelfItem.name }}
+    {{ shelfItem.type }}
+
+
+<svg xmlns="http://www.w3.org/2000/svg" xmlns:pencil="http://www.evolus.vn/Namespace/Pencil" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" id="exportedSVG" version="1.1" pencil:version="1.2.2" sodipodi:docname="semantic_interface.ep" width="100"><g xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" inkscape:label="Cylinder" inkscape:groupmode="layer" id="layer_cylinder"><g><g pencil:type="Shape" pencil:def="Evolus.Common:can" id="0eaa324b97878a45afca9641a49568f1" transform="matrix(1,0,0,1,0,0)"><pencil:metadata><pencil:property name="a">24,13.200000000000001</pencil:property><pencil:property name="box">48,66</pencil:property><pencil:property name="fillColor">#CCCCFFFF</pencil:property><pencil:property name="strokeColor">#1B3280FF</pencil:property><pencil:property name="strokeStyle">2|</pencil:property><pencil:property name="textContent"/><pencil:property name="textFont">"Liberation Sans",Arial,sans-serif|normal|normal|13px|none</pencil:property><pencil:property name="textColor">#000000FF</pencil:property><pencil:property name="textAlign">1,1</pencil:property></pencil:metadata>
+            <defs>
+                <path style="stroke-linejoin: round; stroke: rgb(27, 50, 128); stroke-opacity: 1; stroke-width: 2;" pencil:name="top" id="cc5fb0bc11ce274abba2cb438f0c4c24" transform="translate(0,0)" d="M 0 6.6000000000000005 C 0 3.3000000000000003 12 0 24 0 S 48 3.3000000000000003 48 6.6000000000000005 C 48 9.9 36 13.200000000000001 24 13.200000000000001 S 0 9.9 0 6.6000000000000005 z"/>
+                <mask pencil:name="mask" id="8494ae000634e64580b310296ced8789">
+                    <rect style="fill: white; stroke-linejoin: round; stroke: rgb(27, 50, 128); stroke-opacity: 1; stroke-width: 2;" pencil:name="markContainer" id="49942ef299da0b49b8b9effbfe010b59" transform="translate(0,0)" x="-100" y="-100" width="248" height="266"/>
+                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#cc5fb0bc11ce274abba2cb438f0c4c24" style="fill: black; stroke-linejoin: round;"/>
+                </mask>
+            </defs>
+            <path mask="url(#8494ae000634e64580b310296ced8789)" style="stroke-linejoin: round; stroke: rgb(27, 50, 128); stroke-opacity: 1; stroke-width: 2; fill: rgb(204, 204, 255); fill-opacity: 1;" pencil:name="path" id="29562f59387fb4439ae7770297ae42b8" transform="translate(0,0)" d="M 0 6.6000000000000005 L 0 59.4 C 0 62.7 12 66 24 66 S 48 62.7 48 59.4 L 48 6.6000000000000005 z"/>
+            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#cc5fb0bc11ce274abba2cb438f0c4c24" style="stroke-linejoin: round; stroke: rgb(27, 50, 128); stroke-opacity: 1; stroke-width: 2; fill: rgb(204, 204, 255); fill-opacity: 1;" pencil:name="btop" id="32d436588f19b546b1003b58900ba4f5" transform="translate(0,0)"/>
+            <text pencil:name="text" id="e5b3e4737199af4dac9a59f82401d6ff" style="font-family: &quot;Liberation Sans&quot;,Arial,sans-serif; font-size: 13px; font-weight: normal; font-style: normal; text-decoration: none; fill: rgb(0, 0, 0); fill-opacity: 1;" transform="translate(24,40)"/>
+        </g></g></g></svg>
+
+  </span>
+
+
   <span ng-repeat="shelfItem in shelf" class="shelfItem" screenshot of="shelfItem" ng-click="embed(shelfItem)"></span>
     
 
diff --git a/views/spaces.html b/views/spaces.html
index 2f8521c..a7586a6 100644
--- a/views/spaces.html
+++ b/views/spaces.html
@@ -5,9 +5,14 @@
   <div packery=".context" class="spaces">
 
     <div ng-repeat="feedItem in items" class="context window" prepended data-document-id="{{feedItem._id }}">
+
+      <div class="ui menu">
+        <div class="item" ng-click="openForEditing(feedItem)"><i class="icon medium edit"></i>Open</div>
+      </div>
+
       <div class="fifteen column wide">
       <div class="row">
-        <div angular-content="feedItem.contents" document-index="$index" contenteditable="true" when-blur="update(feedItem)"></div>
+        <div angular-content="feedItem.contents" document-index="$index" contenteditable="true" when-blur="update(feedItem)" incremental="false" update-view-only="true" ng-model="feedItem.html"></div>
       </div>
     </div>
     </div>
diff --git a/views/subdocument.html b/views/subdocument.html
new file mode 100644
index 0000000..0791e9e
--- /dev/null
+++ b/views/subdocument.html
@@ -0,0 +1,4 @@
+<div class="embedded-context"
+    angular-content="documentModel.contents"
+    document-model="documentModel"
+    incremental="false"></div>
\ No newline at end of file
diff --git a/views/wizard.html b/views/wizard.html
new file mode 100644
index 0000000..88f8330
--- /dev/null
+++ b/views/wizard.html
@@ -0,0 +1,29 @@
+<div class="ui small steps">
+  <div class="ui step" ng-class="{active: 'name' == steps[activeStep] }">
+    What is it called?
+  </div>
+  <div class="ui step" ng-class="{active: 'type' == steps[activeStep] }">
+    What type is it?
+  </div>
+  
+  <div class="ui fluid icon input wide">
+    
+
+      <div ng-show="'name' == steps[activeStep]">
+        <form ng-submit="nextStep()">
+          <input ng-model="name" type="text" placeholder="What type is it?" tabindex="0">
+          <input name="submit" type="submit" value="submit"/>
+        </form>
+      </div>
+
+      <div ng-show="'type' == steps[activeStep]">
+        <form ng-submit="nextStep()">
+          <input ng-model="type" type="text" placeholder="What type is it?" tabindex="0">
+          <input name="submit" type="submit" value="submit"/>
+        </form>    
+      </div>
+
+      
+    <i class="search icon"></i>
+  </div>
+</div>
\ No newline at end of file
diff --git a/wordlists/.DS_Store b/wordlists/.DS_Store
new file mode 100644
index 0000000000000000000000000000000000000000..3d9448c62fb956e04dcc15aa5ab0913c4078fcf6
GIT binary patch
literal 6148
zcmeHKO-lnY5PhQsE4}pSF-K1Y|3N5K=vDuK)>bPlu2{YA5A+B4Z}iPfEM#5qCL%L1
zd6Q&bvU#xi03h?%^%*b)Fs3Vt1_P$egIxzDc|;T&V}}{m*x+v23=H%aoAld{(cl3)
zywLaG-`=j8cEw(m=7N6uVa7-qPuQZxBiA}3o7`nnG2VKNBOAZPGj4E?O`R>5z3fSy
zJv@iJ_gJikg#w{KC=d#S0zWFiGh1yuaf~t)2n9lcy#l&FB)VcQ*g4wP!NQ&ZM7>6v
zG1d#Sa#F!uuybS&O`J+}s+1>&IGydO<mG~$qthYf@gZgAug8nn>>NK?IwU(r8482~
zwE~A;o$C32&R=HmkzZ4y77By{|4acHEv^=GE~=cZ-<GFmZK7Y()ikfufX2AG1hAs}
f$cc4&f6|zFxnSq0qiDO)iE$AyL81r+enEjx4}(K7

literal 0
HcmV?d00001

diff --git a/wordlists/lists.def b/wordlists/lists.def
new file mode 100644
index 0000000..f3c8e69
--- /dev/null
+++ b/wordlists/lists.def
@@ -0,0 +1,2 @@
+storage.lst:storage_unit:amount
+phone.lst:phone:number
diff --git a/wordlists/phone.lst b/wordlists/phone.lst
new file mode 100644
index 0000000..fbc630e
--- /dev/null
+++ b/wordlists/phone.lst
@@ -0,0 +1 @@
+^(?:(?:\(?(?:0(?:0|11)\)?[\s-]?\(?|\+)44\)?[\s-]?(?:\(?0\)?[\s-]?)?)|(?:\(?0))(?:(?:\d{5}\)?[\s-]?\d{4,5})|(?:\d{4}\)?[\s-]?(?:\d{5}|\d{3}[\s-]?\d{3}))|(?:\d{3}\)?[\s-]?\d{3}[\s-]?\d{3,4})|(?:\d{2}\)?[\s-]?\d{4}[\s-]?\d{4}))(?:[\s-]?(?:x|ext\.?|\#)\d{3,4})?$
\ No newline at end of file
diff --git a/wordlists/storage b/wordlists/storage
new file mode 100644
index 0000000..bc4435e
--- /dev/null
+++ b/wordlists/storage
@@ -0,0 +1 @@
+gb
diff --git a/wordlists/storage.lst b/wordlists/storage.lst
new file mode 100644
index 0000000..168b6db
--- /dev/null
+++ b/wordlists/storage.lst
@@ -0,0 +1,6 @@
+MiB
+mb
+GiB
+gb
+kb
+KiB
-- 
1.7.10.2 (Apple Git-33)

